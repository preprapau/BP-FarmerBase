<!DOCTYPE html>
<html lang="ne">
<head>
<meta charset="UTF-8">
<title>Business Proposal</title>

<style>
body{
  font-family:"Noto Sans Devanagari","Kalimati","Mangal",system-ui,Arial;
  line-height:1.6;
  color:#000;
}
h1,h2,h3{color:#1b5e20}
table{border-collapse:collapse;width:100%;margin:10px 0}
th,td{border:1px solid #999;padding:6px}
th{background:#eef5ee}
.page{page-break-after:always}
.annex{page-break-before:always}
.center{text-align:center}
.small{font-size:13px;color:#555}

/* screen-only */
.no-print{}

/* buttons */
.toggle,.print-btn{
  position:fixed;right:15px;padding:8px 14px;
  background:#2e7d32;color:#fff;border:none;
  border-radius:6px;cursor:pointer
}
.toggle{top:15px}
.print-btn{bottom:15px}

/* ===== PRINT ===== */
@media print{
  .no-print,button{display:none!important}
  @page{size:A4;margin:18mm}
  body{font-size:14px}
  table{page-break-inside:avoid}
}
</style>
</head>

<body>

<!-- buttons -->
<button class="toggle no-print" onclick="toggleAutoEN()">NE / EN</button>
<button class="print-btn no-print" onclick="window.print()">üñ®Ô∏è Print / PDF</button>

<!-- ================= COVER ================= -->
<div class="page center">
<h1>‡§ï‡•É‡§∑‡§ø ‡§µ‡•ç‡§Ø‡§µ‡§∏‡§æ‡§Ø‡§ø‡§ï ‡§™‡§∞‡§ø‡§Ø‡•ã‡§ú‡§®‡§æ ‡§™‡•ç‡§∞‡§∏‡•ç‡§§‡§æ‡§µ</h1>
<h2 id="projectName">[Project Name]</h2>
<p><b id="orgName">[Organization Name]</b><br>
<span id="orgAddress">[Address]</span></p>
<p class="small">‡§™‡•ç‡§∞‡§∏‡•ç‡§§‡§æ‡§µ ‡§Æ‡§ø‡§§‡§ø : <span id="proposalDate"></span></p>
</div>

<!-- ================= TOC ================= -->
<div class="page">
<h2>‡§µ‡§ø‡§∑‡§Ø ‡§∏‡•Ç‡§ö‡•Ä</h2>
<ol>
<li>‡§∏‡§Ç‡§ï‡•ç‡§∑‡§ø‡§™‡•ç‡§§ ‡§µ‡§ø‡§µ‡§∞‡§£</li>
<li>‡§µ‡•ç‡§Ø‡§µ‡§∏‡§æ‡§Ø ‡§µ‡§ø‡§µ‡§∞‡§£</li>
<li>‡§Ü‡§∞‡•ç‡§•‡§ø‡§ï ‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£</li>
<li>‡§®‡§æ‡§´‡§æ / ‡§®‡•ã‡§ï‡•ç‡§∏‡§æ‡§®</li>
<li>ROI</li>
<li>‡§™‡§∞‡§ø‡§∂‡§ø‡§∑‡•ç‡§ü</li>
</ol>
</div>

<!-- ================= SHORT INFO ================= -->
<div class="page">
<h2>‡§∏‡§Ç‡§ï‡•ç‡§∑‡§ø‡§™‡•ç‡§§ ‡§µ‡§ø‡§µ‡§∞‡§£</h2>
<p id="shortInfoBox"></p>
</div>

<!-- ================= BUSINESS DETAIL ================= -->
<div class="page">
<h2>‡§µ‡•ç‡§Ø‡§µ‡§∏‡§æ‡§Ø ‡§µ‡§ø‡§µ‡§∞‡§£</h2>
<p id="bizDetail"></p>
</div>

<!-- ================= FINANCIAL SUMMARY ================= -->
<div class="page">
<h2>‡§Ü‡§∞‡•ç‡§•‡§ø‡§ï ‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£</h2>
<table>
<tr><th>‡§ï‡•Å‡§≤ ‡§ñ‡§∞‡•ç‡§ö</th><td id="sumExpense">‚Äî</td></tr>
<tr><th>‡§ï‡•Å‡§≤ ‡§Ü‡§Æ‡•ç‡§¶‡§æ‡§®‡•Ä</th><td id="sumIncome">‚Äî</td></tr>
<tr><th>‡§µ‡§æ‡§∞‡•ç‡§∑‡§ø‡§ï ‡§®‡§æ‡§´‡§æ</th><td id="sumProfit">‚Äî</td></tr>
</table>
</div>

<!-- ================= ANNEX : MAP ================= -->
<div class="annex">
<h2>‡§™‡§∞‡§ø‡§∂‡§ø‡§∑‡•ç‡§ü : ‡§™‡§∞‡§ø‡§Ø‡•ã‡§ú‡§®‡§æ ‡§∏‡•ç‡§•‡§æ‡§®</h2>
<iframe id="mapFrame" width="100%" height="380" style="border:0"></iframe>
</div>

<!-- ================= AUTO ENGLISH ================= -->
<script>
/* ===== DICTIONARY ===== */
const neToEn={
 "‡§ï‡•É‡§∑‡§ø ‡§µ‡•ç‡§Ø‡§µ‡§∏‡§æ‡§Ø‡§ø‡§ï ‡§™‡§∞‡§ø‡§Ø‡•ã‡§ú‡§®‡§æ ‡§™‡•ç‡§∞‡§∏‡•ç‡§§‡§æ‡§µ":"Agricultural Business Proposal",
 "‡§µ‡§ø‡§∑‡§Ø ‡§∏‡•Ç‡§ö‡•Ä":"Table of Contents",
 "‡§∏‡§Ç‡§ï‡•ç‡§∑‡§ø‡§™‡•ç‡§§ ‡§µ‡§ø‡§µ‡§∞‡§£":"Executive Summary",
 "‡§µ‡•ç‡§Ø‡§µ‡§∏‡§æ‡§Ø ‡§µ‡§ø‡§µ‡§∞‡§£":"Business Details",
 "‡§Ü‡§∞‡•ç‡§•‡§ø‡§ï ‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£":"Financial Analysis",
 "‡§ï‡•Å‡§≤ ‡§ñ‡§∞‡•ç‡§ö":"Total Expense",
 "‡§ï‡•Å‡§≤ ‡§Ü‡§Æ‡•ç‡§¶‡§æ‡§®‡•Ä":"Total Income",
 "‡§µ‡§æ‡§∞‡•ç‡§∑‡§ø‡§ï ‡§®‡§æ‡§´‡§æ":"Annual Net Profit",
 "‡§™‡§∞‡§ø‡§∂‡§ø‡§∑‡•ç‡§ü":"Annex",
 "‡§™‡§∞‡§ø‡§Ø‡•ã‡§ú‡§®‡§æ ‡§∏‡•ç‡§•‡§æ‡§®":"Project Location",
 "‡§™‡•ç‡§∞‡§∏‡•ç‡§§‡§æ‡§µ ‡§Æ‡§ø‡§§‡§ø":"Proposal Date"
};

function autoEnglish(enable){
 document.querySelectorAll("h1,h2,h3,p,th,td,li").forEach(el=>{
   if(!el.dataset.ne) el.dataset.ne=el.innerText.trim();
   el.dataset.en = neToEn[el.dataset.ne] || el.dataset.ne;
   el.innerText = enable ? el.dataset.en : el.dataset.ne;
 });
}

let en=false;
function toggleAutoEN(){
 en=!en;
 autoEnglish(en);
 document.documentElement.lang=en?"en":"ne";
}
</script>

<!-- ================= DATA LOAD ================= -->
<script>
const key=localStorage.getItem("activeProject");
const p=key?JSON.parse(localStorage.getItem(key)):{};

/* short info */
if(p.shortInfo){
 shortInfoBox.innerHTML=
 `<b>${p.shortInfo.orgName||""}</b><br>
 ‡§¶‡§∞‡•ç‡§§‡§æ ‡§®‡§Ç: ${p.shortInfo.regNo||""}<br>
 PAN: ${p.shortInfo.panNo||""}`;
}

/* business detail */
if(p.businessDetail){
 bizDetail.innerHTML=
 `<b>‡§â‡§¶‡•ç‡§¶‡•á‡§∂‡•ç‡§Ø:</b> ${p.businessDetail.objective||""}<br>
 <b>‡§∏‡•ç‡§•‡§æ‡§®:</b> ${p.businessDetail.location||""}<br>
 <b>‡§Ö‡§µ‡§ß‡§ø:</b> ${p.businessDetail.duration||""}`;
}

/* expense + income */
let expense=0,income=0;
(p.expenseData||[]).forEach(e=>expense+=Number(e.amount||0));
(p.incomeData||[]).forEach(i=>income+=Number(i.amount||0));

let profit=income-expense;

sumExpense.innerText=expense.toLocaleString();
sumIncome.innerText=income.toLocaleString();
sumProfit.innerText=profit.toLocaleString();

/* date */
proposalDate.innerText=new Date().toLocaleDateString();

/* map */
if(p.businessDetail?.location){
 mapFrame.src=
 "https://maps.google.com/maps?q="+
 encodeURIComponent(p.businessDetail.location)+
 "&z=13&output=embed";
}
</script>

</body>
</html>
