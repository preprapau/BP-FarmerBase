<!DOCTYPE html>
<html lang="ne">
<head>
<meta charset="UTF-8">
<title>Short Info | BPMS</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
  font-family:"Noto Sans Devanagari","Kalimati","Mangal","Nirmala UI",system-ui,Arial;
  background:#f4f7f6;
  margin:0;
}
.wrap{
  max-width:950px;
  margin:25px auto;
  background:#fff;
  padding:25px;
  border-radius:10px;
}
h2,h3{color:#2e7d32;margin-top:0}

/* ===== TOP BAR ===== */
.topBar{
  display:grid;
  grid-template-columns:1fr auto 1fr;
  align-items:center;
  margin-bottom:12px;
}
.topBar .left{text-align:left}
.topBar .center{text-align:center}
.topBar .right{text-align:right}

/* form */
label{font-weight:600}
input,select,textarea{
  width:100%;
  padding:8px;
  margin-top:6px;
  font-family:inherit;
}
textarea{min-height:70px}

button{
  border:none;
  border-radius:6px;
  padding:8px 14px;
  cursor:pointer;
  background:#2e7d32;
  color:#fff;
}
.previewBtn{background:#0277bd}

/* preview */
.preview input,
.preview textarea,
.preview select{
  background:#f3f3f3;
  pointer-events:none;
}
.preview-label{
  background:#fff3cd;
  padding:6px 10px;
  border-radius:6px;
  font-size:13px;
  margin-bottom:8px;
}

/* bottom nav */
.nav{
  display:flex;
  justify-content:space-between;
  margin-top:30px;
}
</style>
</head>

<body>

<div class="wrap" id="page">

<!-- ===== TOP CONTROLS ===== -->
<div class="topBar">
  <div class="left">
    <button onclick="location.href='index.html'">тмЕ Home</button>
  </div>

  <div class="center">
    <button class="previewBtn" onclick="togglePreview()">ЁЯСБ Preview / тЬПя╕П Edit</button>
  </div>

  <div class="right">
    <button onclick="location.href='existing-status.html'">Next тЮб</button>
  </div>
</div>

<div id="previewLabel" class="preview-label" style="display:none">
ЁЯСБ Preview Mode (Read-only)
</div>

<h2>тЬПя╕П рд╡реНрдпрд╡рд╕рд╛рдпрдХреЛ рд╕рдВрдХреНрд╖рд┐рдкреНрдд рдЬрд╛рдирдХрд╛рд░реА</h2>

<label>рд╡реНрдпрд╡рд╕рд╛рдп / рдкрд░рд┐рдпреЛрдЬрдирд╛рдХреЛ рдирд╛рдо</label>
<input id="bp_name">

<label>рд╕рдЮреНрдЪрд╛рд▓рди рд╣реБрдиреЗ рд╕реНрдерд╛рди</label>
<input id="bp_location">

<label>рд╡реНрдпрд╡рд╕рд╛рдп / рдЙрддреНрдкрд╛рджрди рдкреНрд░рдХреГрддрд┐</label>
<textarea id="bp_products"></textarea>

<label>рд╕рдЮреНрдЪрд╛рд▓рди рдЧрд░реНрдиреЗ рд╕рдВрд╕реНрдерд╛ / рд╡реНрдпрдХреНрддрд┐</label>
<input id="bp_org">

<label>рд╕рдореНрдкрд░реНрдХ рдирдореНрдмрд░</label>
<input id="bp_phone">

<hr>

<h3>ЁЯПв рд╕рдВрд╕реНрдерд╛рдЧрдд рдЖрд╡рджреНрдзрддрд╛</h3>

<label>рд╕рдВрд╕реНрдерд╛рдХреЛ рдкреНрд░рдХрд╛рд░</label>
<select id="org_type">
  <option value="">-- рдЫрд╛рдиреНрдиреБрд╣реЛрд╕реН --</option>
  <option>рд╕рдореВрд╣</option>
  <option>рд╕рд╣рдХрд╛рд░реА</option>
  <option>рдХрдореНрдкрдиреА</option>
  <option>рдПрдХрд▓ рдЙрджреНрдпрдо</option>
</select>

<label>рд╕рдВрд╕реНрдерд╛ рджрд░реНрддрд╛ рдЫ?</label>
<select id="org_registered">
  <option value="">-- рдЫрд╛рдиреНрдиреБрд╣реЛрд╕реН --</option>
  <option>рдЫ</option>
  <option>рдЫреИрди</option>
</select>

<label>рджрд░реНрддрд╛ рдирд┐рдХрд╛рдп</label>
<input id="reg_authority">

<label>рджрд░реНрддрд╛ рдирдВ</label>
<input id="reg_no">

<label>PAN рдирдВ</label>
<input id="pan_no">

<hr>

<h3>ЁЯСе рд▓рд╛рднрд╛рдиреНрд╡рд┐рдд рд╕рдореВрд╣</h3>

<label>рдорд╣рд┐рд▓рд╛ рд╕рдВрдЦреНрдпрд╛</label>
<input id="female_count" type="number" min="0">

<label>рдкреБрд░реБрд╖ рд╕рдВрдЦреНрдпрд╛</label>
<input id="male_count" type="number" min="0">

<label>рдЕрдиреНрдп (рдпрджрд┐ рднрдП)</label>
<input id="other_count" type="number" min="0">

<label>рдЬрдореНрдорд╛ рд▓рд╛рднрд╛рдиреНрд╡рд┐рдд (Auto)</label>
<input id="total_count" type="number" readonly>

<!-- ===== BOTTOM NAV ===== -->
<div class="nav">
  <button onclick="location.href='index.html'">тмЕ Home</button>
  <button onclick="location.href='existing-status.html'">Next тЮб</button>
</div>

</div>

<script>
/* ===== LOAD PROJECT ===== */
let key = localStorage.getItem("activeProject");
if(!key){
  alert("рдкрд╣рд┐рд▓реЗ Home рдмрд╛рдЯ Project рдЦреЛрд▓реНрдиреБрд╣реЛрд╕реН");
  location.href="index.html";
}
let project = JSON.parse(localStorage.getItem(key));
project.shortInfo = project.shortInfo || {};

/* ===== LOAD ===== */
document.querySelectorAll("input,textarea,select").forEach(el=>{
  if(project.shortInfo[el.id] !== undefined)
    el.value = project.shortInfo[el.id];
});

/* ===== AUTO TOTAL ===== */
function calcTotal(){
  let f = Number(female_count.value)||0;
  let m = Number(male_count.value)||0;
  let o = Number(other_count.value)||0;
  total_count.value = f+m+o;
}
[female_count, male_count, other_count].forEach(el=>{
  el.addEventListener("input", calcTotal);
});

/* ===== AUTOSAVE ===== */
let t;
document.querySelectorAll("input,textarea,select").forEach(el=>{
  el.addEventListener("input",()=>{
    clearTimeout(t);
    t=setTimeout(()=>{
      document.querySelectorAll("input,textarea,select").forEach(i=>{
        project.shortInfo[i.id]=i.value||"";
      });
      project.lastEdited=new Date().toLocaleString("ne-NP");
      localStorage.setItem(key,JSON.stringify(project));
    },600);
  });
});

/* ===== PREVIEW ===== */
let preview=false;
function togglePreview(){
  preview=!preview;
  document.body.classList.toggle("preview",preview);
  previewLabel.style.display = preview ? "block":"none";
}
</script>

</body>
</html>
