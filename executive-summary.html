<!DOCTYPE html>
<html lang="ne">
<head>
<meta charset="UTF-8">
<title>Executive Summary | FarmerBase BP Engine</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
  font-family:"Noto Sans Devanagari","Kalimati","Mangal",system-ui;
  background:#f4f7f6;
  margin:0;
}
.wrap{
  max-width:900px;
  margin:25px auto;
  background:#fff;
  padding:25px;
  border-radius:10px;
}
h2{color:#2e7d32;margin-top:0}
.small{font-size:13px;color:#555}

.summary{
  background:#f9fdf9;
  border:1px solid #dceddc;
  border-radius:8px;
  padding:16px;
  line-height:1.7;
  font-size:15px;
  white-space:pre-line;
}

.note{
  background:#fff3cd;
  padding:8px 12px;
  border-radius:6px;
  font-size:13px;
  margin-bottom:12px;
}

/* nav */
.nav{
  display:flex;
  justify-content:space-between;
  margin-top:25px;
}

button{
  background:#2e7d32;
  color:#fff;
  border:none;
  border-radius:6px;
  padding:8px 16px;
  cursor:pointer;
}

@media print{
  body{background:#fff}
  button,.nav,.note{display:none}
}
</style>
</head>

<body>

<div class="wrap">

<h2>ЁЯУМ Executive Summary (рдХрд╛рд░реНрдпрдХрд╛рд░реА рд╕рд╛рд░)</h2>

<div class="note">
тД╣я╕П рдпреЛ Executive Summary рдкреНрд░рдгрд╛рд▓реАрд▓реЗ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдкрдорд╛ рддрдпрд╛рд░ рдЧрд░реЗрдХреЛ рд╣реЛред
рдЖрд╡рд╢реНрдпрдХ рдкрд░реЗ рдЕрдиреНрдп рдкреГрд╖реНрдард╣рд░реВрдорд╛ рдбрд╛рдЯрд╛ рд╕рдЪреНрдпрд╛рдПрд░ рдпрд╣рд╛рдБ рдкреБрдирдГ рд╣реЗрд░реНрди рд╕рдХрд┐рдиреНрдЫред
</div>

<div id="summaryBox" class="summary">
Executive Summary рд▓реЛрдб рд╣реБрдБрджреИрдЫ...
</div>

<!-- NAV -->
<div class="nav">
  <button onclick="location.href='sustainability-analysis.html'">тмЕ Previous</button>
  <button onclick="window.print()">ЁЯЦи Print / Save PDF</button>
</div>

</div>

<script>
/* ================= EXECUTIVE SUMMARY тАУ AUTO ================= */

const key = localStorage.getItem("activeProject");
if(!key){
  alert("рдкрд╣рд┐рд▓реЗ Project рд╕реБрд░реБ рдЧрд░реНрдиреБрд╣реЛрд╕реН");
  location.href="index.html";
}

const project = JSON.parse(localStorage.getItem(key)) || {};

function generateExecutiveSummary(p){
  let s = p.shortInfo || {};
  let works = p.existingStatus?.works || [];
  let checklist = p.existingStatus?.checklist || [];
  let checked = checklist.filter(c=>c.checked);
  let analysis = p.shortAnalysis || "";
  let sus = p.sustainability || {};

  let text = "";

  /* Intro */
  text += `${s.bp_name || "рдпреЛ рд╡реНрдпрд╡рд╕рд╛рдп"} `;
  if(s.bp_location)
    text += `${s.bp_location} рдХреНрд╖реЗрддреНрд░рдорд╛ рд╕рдЮреНрдЪрд╛рд▓рди рд╣реБрдиреЗ `;
  text += "рд╡реНрдпрд╡рд╕рд╛рдпрд┐рдХ рдкреНрд░рд╕реНрддрд╛рд╡ рд╣реЛред ";

  if(s.bp_products)
    text += `рдпрд╕рдХреЛ рдореБрдЦреНрдп рд╡реНрдпрд╡рд╕рд╛рдпрд┐рдХ рдкреНрд░рдХреГрддрд┐ ${s.bp_products} рд░рд╣реЗрдХреЛ рдЫред `;

  text += "\n\n";

  /* Existing status */
  if(works.length){
    text += `рд╕рдВрд╕реНрдерд╛рд▓реЗ рд╣рд╛рд▓рд╕рдореНрдо ${works.length} рдкреНрд░рдХрд╛рд░рдХрд╛ рдЧрддрд┐рд╡рд┐рдзрд┐, рдЕрдиреБрднрд╡ рд╡рд╛ рдХрд╛рд░реНрдпрд╣рд░реВ рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рд╕рдЮреНрдЪрд╛рд▓рди рдЧрд░рд┐рд╕рдХреЗрдХреЛ рдЫред `;
  }

  if(checked.length){
    text += `${checked.length} рдХрд┐рд╕рд┐рдордХрд╛ рдЖрдзрд╛рд░рднреВрдд рдкреВрд░реНрд╡рд╛рдзрд╛рд░ рддрдерд╛ рд╕реБрд╡рд┐рдзрд╛ рдЙрдкрд▓рдмреНрдз рдЫрдиреНред `;
  }

  text += "\n\n";

  /* Short analysis */
  if(analysis){
    text += analysis + "\n\n";
  }

  /* Sustainability */
  if(sus.strengths?.length){
    text += `рдореБрдЦреНрдп рд╕рдмрд▓ рдкрдХреНрд╖: ${sus.strengths.slice(0,2).join(", ")}ред `;
  }

  if(sus.weaknesses?.length){
    text += `рд╕реБрдзрд╛рд░ рдЧрд░реНрдиреБрдкрд░реНрдиреЗ рдкрдХреНрд╖: ${sus.weaknesses.slice(0,1).join(", ")}ред `;
  }

  if(sus.opportunities?.length){
    text += `рдореБрдЦреНрдп рдЕрд╡рд╕рд░: ${sus.opportunities.slice(0,1).join(", ")}ред `;
  }

  if(sus.solutions?.length){
    text += `рдкрд╣рд┐рдЪрд╛рди рдЧрд░рд┐рдПрдХрд╛ рдЪреБрдиреМрддреА рд╕рдорд╛рдзрд╛рди рдЧрд░реНрди ${sus.solutions.slice(0,1).join(", ")} рд░рдгрдиреАрддрд┐ рдЕрдкрдирд╛рдЗрдиреЗрдЫред `;
  }

  text += "\n\n";

  /* Conclusion */
  text += "рд╕рдордЧреНрд░рдорд╛, рдкреНрд░рд╕реНрддреБрдд рд╡реНрдпрд╡рд╕рд╛рдп рдкреНрд░рд╕реНрддрд╛рд╡ рд╕реНрдерд╛рдиреАрдп рд╕реНрд░реЛрдд, рдЕрдиреБрднрд╡ рд░ рд╕рдореНрднрд╛рд╡рдирд╛рдорд╛ рдЖрдзрд╛рд░рд┐рдд рднрдПрдХрд╛рд▓реЗ ";
  text += "рдЙрдЪрд┐рдд рд▓рдЧрд╛рдиреА, рд╡реНрдпрд╡рд╕реНрдерд╛рдкрди рд░ рдкреНрд░рд╡рд┐рдзрд┐ рдЙрдкрдпреЛрдЧрдХрд╛ рд╕рд╛рде рджреАрдЧреЛ, рдирд╛рдлрд╛рдореБрдЦреА рд░ рд░реЛрдЬрдЧрд╛рд░реА рд╕рд┐рд░реНрдЬрдирд╛ рдЧрд░реНрдиреЗ рдХреНрд╖рдорддрд╛ рд░рд╛рдЦреНрджрдЫред";

  return text;
}

/* render */
summaryBox.innerText = generateExecutiveSummary(project);
</script>

</body>
</html>

