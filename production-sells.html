<!DOCTYPE html>
<html lang="ne">
<head>
<meta charset="UTF-8">
<title>рдЙрддреНрдкрд╛рджрди рддрдерд╛ рдмрд┐рдХреНрд░реА рдпреЛрдЬрдирд╛ | Farmerbase BP Engine</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
  font-family:"Noto Sans Devanagari","Kalimati",system-ui;
  background:#f4f7f6;margin:0
}
.container{
  max-width:1050px;
  margin:20px auto;
  background:#fff;
  padding:25px;
  border-radius:10px
}
h1,h2{color:#2e7d32;text-align:center}
table{
  width:100%;
  border-collapse:collapse;
  margin-top:12px
}
th,td{
  border:1px solid #ccc;
  padding:6px;
  text-align:center
}
th{background:#eef5ee}
input,select{
  width:100%;
  padding:6px;
  box-sizing:border-box
}
button{
  margin-top:15px;
  padding:10px 18px;
  background:#2e7d32;
  color:#fff;
  border:none;
  border-radius:6px;
  cursor:pointer
}
.note{font-size:13px;color:#555;margin-top:8px}
.nav{
  display:flex;
  justify-content:space-between;
  margin-top:25px
}
@media print{
  button,.nav{display:none}
}
</style>
</head>

<body>
<div class="container">

<h1>рдЙрддреНрдкрд╛рджрди рддрдерд╛ рдмрд┐рдХреНрд░реА рдпреЛрдЬрдирд╛</h1>

<!-- ================= BASIC INPUT ================= -->
<table>
<tr><th>рд╡реНрдпрд╡рд╕рд╛рдп рдкреНрд░рдХрд╛рд░</th>
<td>
<select id="bizType">
  <option value="pig">рдмрдВрдЧреБрд░</option>
  <option value="goat">рдмрд╛рдЦреНрд░рд╛</option>
  <option value="veg">рддрд░рдХрд╛рд░реА</option>
</select>
</td></tr>

<tr><th>рдкреНрд░рд╛рд░рдореНрднрд┐рдХ рдмрдпрд╕реНрдХ рд╕рдВрдЦреНрдпрд╛</th><td><input id="adult" value="300"></td></tr>
<tr><th>рдмреНрдпрд╛рдЙрдиреЗ рджрд░ (%)</th><td><input id="breedRate" value="90"></td></tr>
<tr><th>рдкреНрд░рддрд┐ рдмрдпрд╕реНрдХ рд╡рд╛рд░реНрд╖рд┐рдХ рдЙрддреНрдкрд╛рджрди</th><td><input id="kids" value="20"></td></tr>
<tr><th>рдореГрддреНрдпреБрджрд░ (%)</th><td><input id="death" value="10"></td></tr>
<tr><th>рд░рд╛рдЦрд┐рдиреЗ рдкреЛрдереА (%)</th><td><input id="keepFemale" value="40"></td></tr>
<tr><th>рдкреНрд░рддрд┐рд╕реНрдерд╛рдкрди (рдмрдпрд╕реНрдХ рдмрд┐рдХреНрд░реА %)</th><td><input id="replacement" value="10"></td></tr>
</table>

<p class="note">
ЁЯУМ рдпреЛ рднрд╛рдЧ рд╕рдмреИ рд╡реНрдпрд╡рд╕рд╛рдпрдорд╛ рд╕рдорд╛рди рд░рд╣рдиреНрдЫ (label рдорд╛рддреНрд░ рдлрд░рдХ)
</p>

<!-- ================= STAGE DISTRIBUTION ================= -->
<h2>ЁЯФв Stage-wise рд╕рдВрдЦреНрдпрд╛ рд╡рд┐рддрд░рдг</h2>

<table>
<tr>
<th>Stage</th>
<th>Label (Editable)</th>
<th>рджрд┐рди</th>
<th>рд╡рд┐рддрд░рдг %</th>
<th>рд╕рдВрдЦреНрдпрд╛ (Auto)</th>
</tr>

<tr>
<td>S1</td>
<td><input id="l1" value="1тАУ3 рдорд╣рд┐рдирд╛ / рдкреНрд░рд╛рд░рдореНрднрд┐рдХ рдЪрд░рдг"></td>
<td><input id="d1" value="90"></td>
<td><input id="p1" value="30"></td>
<td id="c1">0</td>
</tr>
<tr>
<td>S2</td>
<td><input id="l2" value="4тАУ5 рдорд╣рд┐рдирд╛ / рдмрдвреНрджреЛ"></td>
<td><input id="d2" value="60"></td>
<td><input id="p2" value="25"></td>
<td id="c2">0</td>
</tr>
<tr>
<td>S3</td>
<td><input id="l3" value="5тАУ9 рдорд╣рд┐рдирд╛ / рдЙрддреНрдкрд╛рджрди"></td>
<td><input id="d3" value="120"></td>
<td><input id="p3" value="25"></td>
<td id="c3">0</td>
</tr>
<tr>
<td>S4</td>
<td><input id="l4" value="10+ рдорд╣рд┐рдирд╛ / рдмрдпрд╕реНрдХ"></td>
<td><input id="d4" value="365"></td>
<td><input id="p4" value="20"></td>
<td id="c4">0</td>
</tr>
</table>

<p class="note">
тЬФя╕П % рдкрд░рд┐рд╡рд░реНрддрди рдЧрд░реНрджрд╛ stage рд╕рдВрдЦреНрдпрд╛ рд╕реНрд╡рддрдГ рдмрджрд▓рд┐рдиреНрдЫ<br>
тЬФя╕П рдмрдВрдЧреБрд░ / рдмрд╛рдЦреНрд░рд╛ / рддрд░рдХрд╛рд░реА рд╕рдмреИрдорд╛ рдпрд╣реА logic
</p>

<button onclick="saveAndCalculate()">ЁЯТ╛ Save & Calculate</button>

<!-- ================= RESULT ================= -->
<h2>рел рд╡рд░реНрд╖реЗ рдЙрддреНрдкрд╛рджрдитАУрдмрд┐рдХреНрд░реА рд╕рд╛рд░рд╛рдВрд╢</h2>

<table>
<thead>
<tr>
  <th>рд╡рд░реНрд╖</th>
  <th>рдмрдпрд╕реНрдХ</th>
  <th>рдмрд╛рдБрдЪреЗрдХ рдЙрддреНрдкрд╛рджрди</th>
  <th>рдмрд┐рдХреНрд░реА</th>
  <th>рдЕрд░реНрдХреЛ рд╡рд░реНрд╖ рдмрдпрд╕реНрдХ</th>
</tr>
</thead>
<tbody id="resultBody"></tbody>
</table>

<div class="nav">
  <button onclick="location.href='short-info.html'">тмЕ Previous</button>
  <button onclick="location.href='operating-cost-engine.html'">Next тЮб</button>
</div>

</div>

<script>
function num(id){return Number(document.getElementById(id).value)||0}

function saveAndCalculate(){
  let adult=num("adult")
  let alive=adult*(num("breedRate")/100)*num("kids")
  alive=alive*(100-num("death"))/100

  /* ===== STAGE DISTRIBUTION ===== */
  let stages={
    S1:{label:l1.value,days:num("d1"),pct:num("p1")},
    S2:{label:l2.value,days:num("d2"),pct:num("p2")},
    S3:{label:l3.value,days:num("d3"),pct:num("p3")},
    S4:{label:l4.value,days:num("d4"),pct:num("p4")}
  }

  let totalPct=stages.S1.pct+stages.S2.pct+stages.S3.pct+stages.S4.pct
  if(totalPct!==100){
    alert("Stage рд╡рд┐рддрд░рдг 100% рд╣реБрдиреБрдкрд░реНрдЫ")
    return
  }

  Object.keys(stages).forEach((k,i)=>{
    let c=Math.round(alive*stages[k].pct/100)
    stages[k].count=c
    document.getElementById("c"+(i+1)).innerText=c
  })

  /* ===== SAVE PRODUCTION STAGE DATA ===== */
  localStorage.setItem("PRODUCTION_STAGE_DATA",JSON.stringify({
    businessType:bizType.value,
    adult,
    alive,
    stages
  }))

  /* ===== SIMPLE 5-YEAR SUMMARY ===== */
  let body=resultBody
  body.innerHTML=""
  let curAdult=adult

  for(let y=1;y<=5;y++){
    let nextAdult=curAdult+(alive*(num("keepFemale")/100))
    body.innerHTML+=`
      <tr>
        <td>${y}</td>
        <td>${Math.round(curAdult)}</td>
        <td>${Math.round(alive)}</td>
        <td>${Math.round(alive*(1-num("keepFemale")/100))}</td>
        <td>${Math.round(nextAdult)}</td>
      </tr>
    `
    curAdult=nextAdult
  }
}
</script>

</body>
</html>
