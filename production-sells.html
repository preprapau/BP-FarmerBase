<!DOCTYPE html>
<html lang="ne">
<head>
<meta charset="UTF-8">
<title>Production Master | Farmerbase BP Engine</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{font-family:"Noto Sans Devanagari","Kalimati",system-ui;background:#f4f7f6;margin:0}
header,footer{background:#e8f5e9;padding:10px 16px;display:flex;justify-content:space-between}
header a,footer a{color:#2e7d32;font-weight:600;text-decoration:none}
.wrap{max-width:1100px;margin:18px auto;background:#fff;padding:22px;border-radius:12px}
h2{color:#2e7d32}
table{width:100%;border-collapse:collapse;margin-top:10px}
th,td{border:1px solid #ccc;padding:6px;text-align:center}
th{background:#eef5ee}
input,select,textarea{width:100%;padding:6px;box-sizing:border-box}
button{padding:6px 12px;background:#2e7d32;color:#fff;border:none;border-radius:6px}
.del{background:#c62828}
.auto{color:#2e7d32;font-size:13px}
.hidden{display:none}
</style>
</head>

<body>

<header>
  <a href="index.html">ЁЯПа Home</a>
  <a href="operating-cost-engine.html">Operating Cost тЦ╢я╕П</a>
</header>

<div class="wrap">

<h2>ЁЯУж рдЙрддреНрдкрд╛рджрди рд╕рд╛рд░рд╛рдВрд╢ (рд╕рдмреИ рд╡реНрдпрд╡рд╕рд╛рдп)</h2>

<table>
<thead>
<tr>
  <th>рдЙрддреНрдкрд╛рджрди</th>
  <th>Logic</th>
  <th>рдкрд░рд┐рдорд╛рдг</th>
  <th>рдЗрдХрд╛рдИ</th>
  <th>рдХреИрдлрд┐рдпрдд</th>
  <th></th>
</tr>
</thead>
<tbody id="body"></tbody>
</table>

<div style="margin-top:8px">
<input id="pName" placeholder="рдЙрддреНрдкрд╛рджрди (рдЬрд╕реНрддреИ: рдмрд╛рдЦреНрд░рд╛, рдЧрд╛рдИ, рддрд░рдХрд╛рд░реА)">
<input id="pQty" placeholder="рдкрд░рд┐рдорд╛рдг">
<input id="pUnit" placeholder="рдЗрдХрд╛рдИ">
<input id="pNote" placeholder="рдХреИрдлрд┐рдпрдд">
<button onclick="add()">+ Add</button>
</div>

<p class="auto">тЬФя╕П рдирд╛рдо рдЯрд╛рдЗрдк рдЧрд░реНрджрд╛ logic auto-suggest рд╣реБрдиреНрдЫ | рд╕рдмреИ Auto-Save</p>

</div>

<footer>
  <a href="index.html">ЁЯПа Home</a>
</footer>

<script>
const LOGIC_MAP={
  "рдмрд╛рдЦреНрд░рд╛":"breeding","рдмрдВрдЧреБрд░":"breeding",
  "рдЧрд╛рдИ":"dairy","рднреИрдВрд╕реА":"dairy","рджреВрдз":"dairy",
  "рддрд░рдХрд╛рд░реА":"crop","рдзрд╛рди":"crop","рдордХреИ":"crop","рдЖрд▓реБ":"crop"
};

let data = JSON.parse(localStorage.getItem("PRODUCTION_MASTER")) || [];

function suggestLogic(name){
  return LOGIC_MAP[name] || "generic";
}

function render(){
  body.innerHTML="";
  data.forEach(p=>{
    if(Number(p.qty)===0) return; // ЁЯФС auto hide
    body.innerHTML+=`
    <tr>
      <td>
        <input value="${p.name}"
          oninput="edit('${p.id}','name',this.value)">
      </td>
      <td>
        <select onchange="edit('${p.id}','logicType',this.value)">
          <option value="breeding" ${p.logicType==="breeding"?"selected":""}>рдкрд╛рд▓рди</option>
          <option value="dairy" ${p.logicType==="dairy"?"selected":""}>рджреБрдЧреНрдз</option>
          <option value="crop" ${p.logicType==="crop"?"selected":""}>рдЦреЗрддреА</option>
          <option value="generic" ${p.logicType==="generic"?"selected":""}>рд╕рд╛рдорд╛рдиреНрдп</option>
        </select>
      </td>
      <td><input value="${p.qty}" oninput="edit('${p.id}','qty',this.value)"></td>
      <td><input value="${p.unit}" oninput="edit('${p.id}','unit',this.value)"></td>
      <td><input value="${p.note}" oninput="edit('${p.id}','note',this.value)"></td>
      <td><button class="del" onclick="del('${p.id}')">тЭМ</button></td>
    </tr>`;
  });
}

function add(){
  if(!pName.value) return;
  data.push({
    id:Date.now(),
    name:pName.value,
    logicType:suggestLogic(pName.value),
    qty:pQty.value||0,
    unit:pUnit.value,
    note:pNote.value
  });
  pName.value=pQty.value=pUnit.value=pNote.value="";
  save();
}

function edit(id,f,v){
  let p=data.find(x=>x.id==id);
  if(!p) return;
  if(f==="name") p.logicType=suggestLogic(v);
  p[f]=v;
  save();
}

function del(id){
  data=data.filter(x=>x.id!=id);
  save();
}

function save(){
  localStorage.setItem("PRODUCTION_MASTER",JSON.stringify(data));
  render();
}

render();
</script>

</body>
</html>
