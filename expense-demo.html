<!DOCTYPE html>
<html lang="ne">
<head>
<meta charset="UTF-8">
<title>‡§ñ‡§∞‡•ç‡§ö ‡§µ‡§ø‡§µ‡§∞‡§£ (Expense Entry)</title>

<style>
body{
  font-family:"Noto Sans Devanagari","Kalimati","Mangal",Arial;
  background:#f4f7f6;
  padding:20px;
}
h1{color:#2e7d32}
select,input,button{
  padding:8px;
  font-size:14px;
}
button{
  cursor:pointer;
}
table{
  width:100%;
  border-collapse:collapse;
  margin-top:15px;
}
th,td{
  border:1px solid #cfd8dc;
  padding:8px;
  text-align:center;
}
th{
  background:#e8f5e9;
}
.group-row{
  background:#d9f2dc;
  font-weight:bold;
  text-align:left;
}
.summary{
  background:#f1f8e9;
  font-weight:bold;
}
.note{
  margin-top:10px;
  color:#2e7d32;
}
.remove{
  background:#e53935;
  color:#fff;
  border:none;
  padding:4px 8px;
}
</style>
</head>

<body>

<h1>üí∞ ‡§ñ‡§∞‡•ç‡§ö ‡§µ‡§ø‡§µ‡§∞‡§£ (Expense Entry)</h1>

<label>
<input type="checkbox" id="advancedMode">
 Advanced Mode (‡§π‡•ç‡§∞‡§æ‡§∏‡§ï‡§ü‡•ç‡§ü‡•Ä ‡§∏‡§π‡§ø‡§§)
</label>

<br><br>

<!-- CENTRAL METHOD SELECT -->
<select id="method">
  <option value="‡§™‡•ç‡§∞‡§æ‡§∞‡§Æ‡•ç‡§≠‡§ø‡§ï ‡§≤‡§ó‡§æ‡§®‡•Ä">‡§™‡•ç‡§∞‡§æ‡§∞‡§Æ‡•ç‡§≠‡§ø‡§ï ‡§≤‡§ó‡§æ‡§®‡•Ä</option>
  <option value="‡§Æ‡•á‡§∂‡•Ä‡§® ‡§î‡§ú‡§æ‡§∞ / ‡§™‡•ç‡§∞‡§µ‡§ø‡§ß‡§ø">‡§Æ‡•á‡§∂‡•Ä‡§® ‡§î‡§ú‡§æ‡§∞ / ‡§™‡•ç‡§∞‡§µ‡§ø‡§ß‡§ø</option>
  <option value="‡§™‡•Ç‡§∞‡•ç‡§µ‡§æ‡§ß‡§æ‡§∞ ‡§®‡§ø‡§∞‡•ç‡§Æ‡§æ‡§£">‡§™‡•Ç‡§∞‡•ç‡§µ‡§æ‡§ß‡§æ‡§∞ ‡§®‡§ø‡§∞‡•ç‡§Æ‡§æ‡§£</option>
  <option value="‡§ï‡§ö‡•ç‡§ö‡§æ‡§™‡§¶‡§æ‡§∞‡•ç‡§•">‡§ï‡§ö‡•ç‡§ö‡§æ‡§™‡§¶‡§æ‡§∞‡•ç‡§•</option>
  <option value="‡§µ‡§ø‡§µ‡§ø‡§ß">‡§µ‡§ø‡§µ‡§ø‡§ß</option>
</select>

<input id="title" placeholder="‡§ñ‡§∞‡•ç‡§ö ‡§∂‡•Ä‡§∞‡•ç‡§∑‡§ï">
<input id="qty" type="number" placeholder="‡§™‡§∞‡§ø‡§Æ‡§æ‡§£">
<input id="rate" type="number" placeholder="‡§¶‡§∞ (‡§∞‡•Å.)">

<button onclick="addExpense()">‚ûï Add</button>

<div class="note">
‚úîÔ∏è ‡§µ‡§ø‡§ß‡§æ Central ‡§õ<br>
‚úîÔ∏è ‡§π‡•ç‡§∞‡§æ‡§∏‡§ï‡§ü‡•ç‡§ü‡•Ä ‡§ï‡•á‡§µ‡§≤ ‡§Æ‡•á‡§∂‡•Ä‡§® ‡§î‡§ú‡§æ‡§∞ ‡§∞ ‡§™‡•Ç‡§∞‡•ç‡§µ‡§æ‡§ß‡§æ‡§∞‡§Æ‡§æ (Advanced Mode)<br>
‚úîÔ∏è ‡§™‡•ç‡§∞‡§æ‡§∞‡§Æ‡•ç‡§≠‡§ø‡§ï ‡§≤‡§ó‡§æ‡§®‡•Ä, ‡§ï‡§ö‡•ç‡§ö‡§æ‡§™‡§¶‡§æ‡§∞‡•ç‡§•, ‡§µ‡§ø‡§µ‡§ø‡§ß = ‡§π‡•ç‡§∞‡§æ‡§∏‡§ï‡§ü‡•ç‡§ü‡•Ä ‡§π‡•Å‡§Å‡§¶‡•à‡§®
</div>

<table id="expenseTable">
<thead>
<tr>
  <th>‡§∂‡•Ä‡§∞‡•ç‡§∑‡§ï</th>
  <th>‡§™‡§∞‡§ø‡§Æ‡§æ‡§£</th>
  <th>‡§¶‡§∞</th>
  <th>‡§∞‡§ï‡§Æ</th>
  <th>‡§π‡•ç‡§∞‡§æ‡§∏‡§ï‡§ü‡•ç‡§ü‡•Ä (‡§µ‡§æ‡§∞‡•ç‡§∑‡§ø‡§ï)</th>
  <th></th>
</tr>
</thead>
<tbody id="tbody"></tbody>

<tfoot>
<tr class="summary">
  <td colspan="3">‡§ï‡•Å‡§≤ ‡§ñ‡§∞‡•ç‡§ö (Cash)</td>
  <td id="totalCash">0</td>
  <td></td>
  <td></td>
</tr>
<tr class="summary">
  <td colspan="4">‡§ï‡•Å‡§≤ ‡§µ‡§æ‡§∞‡•ç‡§∑‡§ø‡§ï ‡§π‡•ç‡§∞‡§æ‡§∏‡§ï‡§ü‡•ç‡§ü‡•Ä</td>
  <td id="totalDep">0</td>
  <td></td>
</tr>
</tfoot>
</table>

<script>
let expenses = [];

function addExpense(){
  const method = method.value;
  const title = document.getElementById("title").value;
  const qty = Number(document.getElementById("qty").value || 1);
  const rate = Number(document.getElementById("rate").value || 0);
  const adv = document.getElementById("advancedMode").checked;

  if(!title || rate<=0){
    alert("‡§∂‡•Ä‡§∞‡•ç‡§∑‡§ï ‡§∞ ‡§¶‡§∞ ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï");
    return;
  }

  let amount = qty * rate;
  let dep = 0;

  if(adv && (method==="‡§Æ‡•á‡§∂‡•Ä‡§® ‡§î‡§ú‡§æ‡§∞ / ‡§™‡•ç‡§∞‡§µ‡§ø‡§ß‡§ø" || method==="‡§™‡•Ç‡§∞‡•ç‡§µ‡§æ‡§ß‡§æ‡§∞ ‡§®‡§ø‡§∞‡•ç‡§Æ‡§æ‡§£")){
    dep = amount * 0.15; // 15% depreciation
  }

  expenses.push({method,title,qty,rate,amount,dep});
  render();
  document.getElementById("title").value="";
  document.getElementById("qty").value="";
  document.getElementById("rate").value="";
}

function render(){
  const tb = document.getElementById("tbody");
  tb.innerHTML="";
  let cash=0, dep=0;
  let groups = {};

  expenses.forEach(e=>{
    if(!groups[e.method]) groups[e.method]=[];
    groups[e.method].push(e);
  });

  for(let g in groups){
    let gr = document.createElement("tr");
    gr.className="group-row";
    gr.innerHTML=`<td colspan="6">‚óÜ ${g}</td>`;
    tb.appendChild(gr);

    groups[g].forEach((e,i)=>{
      cash+=e.amount;
      dep+=e.dep;
      let tr=document.createElement("tr");
      tr.innerHTML=`
        <td>${e.title}</td>
        <td>${e.qty}</td>
        <td>${e.rate}</td>
        <td>${e.amount}</td>
        <td>${e.dep.toFixed(0)}</td>
        <td><button class="remove" onclick="removeExpense(${expenses.indexOf(e)})">‚úñ</button></td>
      `;
      tb.appendChild(tr);
    });
  }

  totalCash.innerText=cash.toFixed(0);
  totalDep.innerText=dep.toFixed(0);

  // Profit/Loss page use
  localStorage.setItem("TOTAL_EXPENSE",cash);
  localStorage.setItem("TOTAL_DEPRECIATION",dep);
}

function removeExpense(i){
  expenses.splice(i,1);
  render();
}
</script>

</body>
</html>
