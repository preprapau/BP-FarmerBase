<!DOCTYPE html>
<html lang="ne">
<head>
<meta charset="UTF-8">
<title>Expense | FarmerBase BP Engine</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
  font-family:"Noto Sans Devanagari","Kalimati",system-ui;
  background:#f4f7f6;
  margin:0;
}
header,footer{
  background:#e8f5e9;
  padding:10px 16px;
  display:flex;
  justify-content:space-between;
  align-items:center;
}
header a,footer a{
  text-decoration:none;
  font-weight:700;
  color:#2e7d32;
}
.container{
  max-width:1200px;
  margin:0 auto;
  padding:20px;
}
h2,h3{color:#2e7d32;margin:8px 0}
.small{font-size:13px;color:#555}

.section{
  background:#fff;
  padding:14px;
  border-radius:10px;
  margin-bottom:14px;
}

table{
  width:100%;
  border-collapse:collapse;
}
th,td{
  border:1px solid #ccc;
  padding:6px;
  font-size:14px;
}
th{background:#eef5ee}
.right{text-align:right}

input,select,textarea{
  width:100%;
  padding:6px;
  box-sizing:border-box;
}

.inline{
  display:flex;
  gap:6px;
  flex-wrap:wrap;
  align-items:center;
}

.btn{
  padding:6px 12px;
  background:#2e7d32;
  color:#fff;
  border:none;
  cursor:pointer;
}

.del{
  color:#c62828;
  cursor:pointer;
  font-weight:700;
}

.footerNav{
  display:flex;
  justify-content:space-between;
  width:100%;
}

@media print{
  header, footer, button{display:none}
  body{background:#fff}
}
</style>
</head>

<body>

<!-- TOP NAV -->
<header>
  <a href="production.html">‚¨ÖÔ∏è Production</a>
  <strong>üí∏ Expense</strong>
  <a href="production-cost-summary.html">‚û°Ô∏è Cost Summary</a>
</header>

<div class="container">

<h2>‡§ñ‡§∞‡•ç‡§ö ‡§µ‡§ø‡§µ‡§∞‡§£ (Expense Entry)</h2>
<p class="small">
‡§â‡§§‡•ç‡§™‡§æ‡§¶‡§®‡§∏‡§Å‡§ó ‡§∏‡§Æ‡•ç‡§¨‡§®‡•ç‡§ß‡§ø‡§§ ‡§∏‡§Æ‡•ç‡§™‡•Ç‡§∞‡•ç‡§£ ‡§ñ‡§∞‡•ç‡§ö ‡§Ø‡§π‡§æ‡§Å ‡§™‡•ç‡§∞‡§µ‡§ø‡§∑‡•ç‡§ü ‡§ó‡§∞‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç‡•§
</p>

<!-- ADD EXPENSE -->
<div class="section">
<h3>‚ûï ‡§®‡§Ø‡§æ‡§Å ‡§ñ‡§∞‡•ç‡§ö ‡§•‡§™‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç</h3>

<div class="inline">
  <input id="eHead" placeholder="‡§ñ‡§∞‡•ç‡§ö ‡§∂‡•Ä‡§∞‡•ç‡§∑‡§ï (‡§¶‡§æ‡§®‡§æ, ‡§Æ‡§ú‡§¶‡•Å‡§∞‡•Ä‚Ä¶)">
  <input type="number" id="eAmount" placeholder="‡§∞‡§ï‡§Æ">
  <select id="eCategory">
    <option>‡§ö‡§æ‡§≤‡•Å ‡§ñ‡§∞‡•ç‡§ö</option>
    <option>‡§™‡•Ç‡§∞‡•ç‡§µ‡§æ‡§ß‡§æ‡§∞ ‡§®‡§ø‡§∞‡•ç‡§Æ‡§æ‡§£</option>
    <option>‡§Æ‡•á‡§∂‡§ø‡§® ‡§î‡§ú‡§æ‡§∞</option>
    <option>‡§Ö‡§®‡•ç‡§Ø</option>
  </select>

  <select id="eAllocation">
    <option value="LS">‡§∏‡§¨‡•à ‡§â‡§§‡•ç‡§™‡§æ‡§¶‡§® (LS)</option>
    <option value="DIRECT">‡§è‡§ï ‡§â‡§§‡•ç‡§™‡§æ‡§¶‡§®</option>
    <option value="%">‡§™‡•ç‡§∞‡§§‡§ø‡§∂‡§§ ‡§Ö‡§®‡•Å‡§∏‡§æ‡§∞</option>
  </select>

  <button class="btn" onclick="addExpense()">Add</button>
</div>

<p class="small">
‚ÑπÔ∏è ‡§ñ‡§∞‡•ç‡§ö ‡§ï‡§∏‡§∞‡•Ä ‡§â‡§§‡•ç‡§™‡§æ‡§¶‡§®‡§Æ‡§æ ‡§¨‡§æ‡§Å‡§°‡•ç‡§®‡•á ‡§≠‡§®‡•ç‡§®‡•á ‡§ï‡•Å‡§∞‡§æ Allocation Type ‡§≤‡•á ‡§®‡§ø‡§∞‡•ç‡§ß‡§æ‡§∞‡§£ ‡§ó‡§∞‡•ç‡§õ‡•§
</p>
</div>

<!-- EXPENSE TABLE -->
<div class="section">
<h3>üìã ‡§ñ‡§∞‡•ç‡§ö ‡§∏‡•Ç‡§ö‡•Ä</h3>

<table>
<thead>
<tr>
  <th>‡§ñ‡§∞‡•ç‡§ö ‡§∂‡•Ä‡§∞‡•ç‡§∑‡§ï</th>
  <th>‡§∂‡•ç‡§∞‡•á‡§£‡•Ä</th>
  <th>Allocation</th>
  <th class="right">‡§∞‡§ï‡§Æ (‡§∞‡•Å)</th>
  <th></th>
</tr>
</thead>
<tbody id="tbody"></tbody>
<tr>
  <th colspan="3">‡§ï‡•Å‡§≤ ‡§ñ‡§∞‡•ç‡§ö</th>
  <th class="right" id="totalExpense">0</th>
  <th></th>
</tr>
</table>
</div>

</div>

<!-- BOTTOM NAV -->
<footer>
  <div class="footerNav">
    <a href="production.html">‚¨ÖÔ∏è Production</a>
    <span class="small">FarmerBase BP Engine ‚Äì Expense Module</span>
    <a href="production-cost-summary.html">‚û°Ô∏è Cost Summary</a>
  </div>
</footer>

<script>
/* ===============================
   EXPENSE DEMO ‚Äì FINAL
   =============================== */

const key = localStorage.getItem("activeProject");
if(!key){ alert("Active ‡§Ø‡•ã‡§ú‡§®‡§æ ‡§≠‡•á‡§ü‡§ø‡§è‡§®"); }

const project = JSON.parse(localStorage.getItem(key)) || {};
project.expenses = project.expenses || [];
const expenses = project.expenses;

/* -------- SAVE -------- */
function save(){
  localStorage.setItem(key, JSON.stringify(project));
  render();
}

/* -------- ADD -------- */
function addExpense(){
  if(!eHead.value || !eAmount.value) return;

  expenses.push({
    id:Date.now(),
    head:eHead.value,
    amount:+eAmount.value||0,
    category:eCategory.value,
    allocationType:eAllocation.value
  });

  eHead.value="";
  eAmount.value="";
  save();
}

/* -------- DELETE -------- */
function remove(i){
  if(!confirm("‡§Ø‡•ã ‡§ñ‡§∞‡•ç‡§ö ‡§π‡§ü‡§æ‡§â‡§®‡•á ?")) return;
  expenses.splice(i,1);
  save();
}

/* -------- RENDER -------- */
function render(){
  tbody.innerHTML="";
  let sum=0;

  expenses.forEach((e,i)=>{
    sum+=e.amount||0;
    tbody.innerHTML+=`
    <tr>
      <td>${e.head}</td>
      <td>${e.category}</td>
      <td>${e.allocationType}</td>
      <td class="right">${e.amount.toLocaleString()}</td>
      <td class="del" onclick="remove(${i})">‚úñ</td>
    </tr>`;
  });

  totalExpense.innerText=sum.toLocaleString();
}

render();
</script>

</body>
</html>
