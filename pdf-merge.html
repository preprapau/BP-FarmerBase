<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>PDF Merge Tool | FarmerBase</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- PDF-LIB (client-side) -->
<script src="https://unpkg.com/pdf-lib/dist/pdf-lib.min.js"></script>

<style>
body{
  font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto;
  background:#f4f7f6;
  margin:0;
}
.wrap{
  max-width:800px;
  margin:30px auto;
  background:#fff;
  padding:24px;
  border-radius:10px;
}
h2{color:#2e7d32;margin-top:0}

input[type=file]{
  width:100%;
  margin:10px 0;
}

ul{
  list-style:none;
  padding:0;
}
li{
  background:#f1f8e9;
  margin:6px 0;
  padding:8px 10px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  border-radius:6px;
}
li span{font-size:14px}

button{
  border:none;
  border-radius:6px;
  padding:8px 14px;
  cursor:pointer;
  background:#2e7d32;
  color:#fff;
}
button.small{
  padding:4px 8px;
  font-size:12px;
  background:#0277bd;
}
button.del{
  background:#c62828;
}

.actions{
  display:flex;
  gap:6px;
}

.footer{
  margin-top:20px;
  display:flex;
  justify-content:space-between;
  flex-wrap:wrap;
  gap:10px;
}
.note{
  font-size:13px;
  color:#555;
}
</style>
</head>

<body>

<div class="wrap">

<h2>üìé PDF Merge Tool</h2>
<p class="note">
PDF ‡§´‡§æ‡§á‡§≤‡§π‡§∞‡•Ç select ‡§ó‡§∞‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç, order ‡§Æ‡§ø‡§≤‡§æ‡§â‡§®‡•Å‡§π‡•ã‡§∏‡•ç, ‡§Ö‡§®‡§ø ‡§è‡§â‡§ü‡§æ merged PDF download ‡§ó‡§∞‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç‡•§
‡§∏‡§¨‡•à ‡§ï‡§æ‡§Æ ‡§§‡§™‡§æ‡§à‡§Ç‡§ï‡•ã browser ‡§≠‡§ø‡§§‡•ç‡§∞‡•à ‡§π‡•Å‡§®‡•ç‡§õ‡•§
</p>

<input type="file" id="fileInput" accept="application/pdf" multiple>

<ul id="fileList"></ul>

<div class="footer">
  <button onclick="mergePDFs()">üß© Merge & Download</button>
  <span class="note">Order: Full Proposal ‚Üí Annex-A ‚Üí Annex-B ‚Üí Annex-C</span>
</div>

</div>

<script>
const files = [];

fileInput.addEventListener("change", e=>{
  for(const f of e.target.files){
    files.push(f);
  }
  render();
  fileInput.value="";
});

function render(){
  fileList.innerHTML="";
  files.forEach((f,i)=>{
    const li=document.createElement("li");
    li.innerHTML=`
      <span>${i+1}. ${f.name}</span>
      <div class="actions">
        <button class="small" onclick="moveUp(${i})">‚Üë</button>
        <button class="small" onclick="moveDown(${i})">‚Üì</button>
        <button class="del small" onclick="removeFile(${i})">‚úñ</button>
      </div>`;
    fileList.appendChild(li);
  });
}

function moveUp(i){
  if(i===0) return;
  [files[i-1],files[i]]=[files[i],files[i-1]];
  render();
}
function moveDown(i){
  if(i===files.length-1) return;
  [files[i+1],files[i]]=[files[i],files[i+1]];
  render();
}
function removeFile(i){
  files.splice(i,1);
  render();
}

async function mergePDFs(){
  if(files.length<2){
    alert("‡§ï‡§Æ‡•ç‡§§‡•Ä‡§Æ‡§æ 2 PDF ‡§ö‡§æ‡§π‡§ø‡§®‡•ç‡§õ");
    return;
  }

  const mergedPdf = await PDFLib.PDFDocument.create();

  for(const file of files){
    const bytes = await file.arrayBuffer();
    const pdf = await PDFLib.PDFDocument.load(bytes);
    const pages = await mergedPdf.copyPages(pdf, pdf.getPageIndices());
    pages.forEach(p=>mergedPdf.addPage(p));
  }

  const mergedBytes = await mergedPdf.save();
  const blob = new Blob([mergedBytes], { type:"application/pdf" });
  const url = URL.createObjectURL(blob);

  const a=document.createElement("a");
  a.href=url;
  a.download="FarmerBase_Full_Proposal_Merged.pdf";
  a.click();

  URL.revokeObjectURL(url);
}
</script>

</body>
</html>
