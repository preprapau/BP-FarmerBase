<!DOCTYPE html>
<html lang="ne">
<head>
<meta charset="UTF-8">
<title>ROI & Financial Indicators | BPMS</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
  font-family:"Noto Sans Devanagari","Kalimati",system-ui;
  background:#f4f7f6;margin:0;
}
.wrap{
  max-width:1100px;margin:25px auto;
  background:#fff;padding:30px;border-radius:12px;
}
h2,h3{color:#2e7d32;margin-top:0}
table{width:100%;border-collapse:collapse;margin-top:12px}
th,td{border:1px solid #ccc;padding:8px}
th{background:#eef5ee}
.right{text-align:right}
input{width:120px;padding:6px}
.note{font-size:13px;color:#555;margin-top:8px}

@media print{
  button{display:none}
  a[href]:after{content:""}
}
</style>
</head>

<body>
<div class="wrap">

<h2>ЁЯУК ROI рддрдерд╛ рд╡рд┐рддреНрддреАрдп рд╕реВрдЪрдХ рд╡рд┐рд╢реНрд▓реЗрд╖рдг (Editable)</h2>

<!-- ================= INPUTS ================= -->
<h3>рез. рдЖрдзрд╛рд░рднреВрдд рдЗрдирдкреБрдЯ</h3>
<table>
<tr><td>рдкреНрд░рд╛рд░рдореНрднрд┐рдХ рд▓рдЧрд╛рдиреА</td><td class="right"><input id="investment" value="6500000"></td></tr>
<tr><td>рд╡рд╛рд░реНрд╖рд┐рдХ рдЖрдореНрджрд╛рдиреА</td><td class="right"><input id="revenue" value="24250000"></td></tr>
<tr><td>рд╡рд╛рд░реНрд╖рд┐рдХ рдЪрд╛рд▓реБ рдЦрд░реНрдЪ</td><td class="right"><input id="opex" value="750000"></td></tr>
<tr><td>рд╣реНрд░рд╛рд╕рдХрдЯреНрдЯреА</td><td class="right"><input id="depr" value="1000000"></td></tr>
<tr><td>рдмреИрдВрдХ рдмреНрдпрд╛рдЬ</td><td class="right"><input id="interest" value="780000"></td></tr>
<tr><td>рдХрд░ рджрд░ (%)</td><td class="right"><input id="taxRate" value="25"></td></tr>
<tr><td>рд▓рд╛рднрд╛рдВрд╢ (%)</td><td class="right"><input id="divRate" value="60"></td></tr>
<tr><td>Discount Rate (%)</td><td class="right"><input id="discRate" value="10"></td></tr>
</table>

<button onclick="calculate()">ЁЯФД Calculate</button>

<!-- ================= PROFIT ================= -->
<h3>реи. рдирд╛рдлрд╛ / рдиреЛрдХреНрд╕рд╛рди рд╡рд┐рд╡рд░рдг</h3>
<table>
<tr><th>рд╡рд┐рд╡рд░рдг</th><th class="right">рд░рдХрдо (рд░реБ.)</th></tr>
<tr><td>EBIT</td><td class="right" id="ebit"></td></tr>
<tr><td>рдХрд░ рдЕрдШрд┐рдХреЛ рдирд╛рдлрд╛ (PBT)</td><td class="right" id="pbt"></td></tr>
<tr><td>рдХрд░</td><td class="right" id="tax"></td></tr>
<tr><td><b>рдЦреБрдж рдирд╛рдлрд╛ (PAT)</b></td><td class="right" id="pat"></td></tr>
<tr><td>Operating Cash Flow</td><td class="right" id="ocf"></td></tr>
</table>

<!-- ================= ROI ================= -->
<h3>рей. ROI / Investment Indicators</h3>
<table>
<tr><th>рд╕реВрдЪрдХ</th><th class="right">рдкрд░рд┐рдгрд╛рдо</th></tr>
<tr><td>Payback Period</td><td class="right" id="payback"></td></tr>
<tr><td>IRR (Approx)</td><td class="right" id="irr"></td></tr>
<tr><td>NPV (5 yrs)</td><td class="right" id="npv"></td></tr>
</table>

<!-- ================= RATIOS ================= -->
<h3>рек. рдмреИрдВрдХ / рд╡рд┐рддреНрддреАрдп рдЕрдиреБрдкрд╛рдд</h3>
<table>
<tr><th>рдЕрдиреБрдкрд╛рдд</th><th class="right">рдореВрд▓реНрдп</th></tr>
<tr><td>DebtтАУEquity Ratio</td><td class="right" id="de"></td></tr>
<tr><td>Interest Coverage Ratio</td><td class="right" id="icr"></td></tr>
<tr><td>Cash Flow Adequacy Ratio</td><td class="right" id="cfa"></td></tr>
<tr><td>Operating Margin</td><td class="right" id="opm"></td></tr>
<tr><td>Dividend / Profit Ratio</td><td class="right" id="divr"></td></tr>
</table>

<p class="note">
тЬФ Editable values тАУ рдмреИрдВрдХ/рдЕрдиреБрджрд╛рдирдХрд╛ рд▓рд╛рдЧрд┐ рдЙрдкрдпреБрдХреНрдд  
тЬФ Print-friendly, URL-less  
тЬФ Proposal рд╡рд╛ Annex рдорд╛ рд╕рд┐рдзреИ рдЬреЛрдбреНрди рдорд┐рд▓реНрдиреЗ
</p>

</div>

<script>
function n(id){return Number(document.getElementById(id).value)||0}

function calculate(){
  let inv=n("investment"),
      rev=n("revenue"),
      op=n("opex"),
      dep=n("depr"),
      int=n("interest"),
      taxR=n("taxRate")/100,
      divR=n("divRate")/100,
      disc=n("discRate")/100;

  let EBIT = rev - op - dep;
  let PBT = EBIT - int;
  let tax = PBT>0 ? PBT*taxR : 0;
  let PAT = PBT - tax;
  let OCF = PAT + dep;

  ebit.innerText=Math.round(EBIT);
  pbt.innerText=Math.round(PBT);
  taxEl=tax; document.getElementById("tax").innerText=Math.round(tax);
  pat.innerText=Math.round(PAT);
  ocf.innerText=Math.round(OCF);

  /* Payback */
  payback.innerText = OCF>0 ? (inv/OCF).toFixed(2)+" рд╡рд░реНрд╖" : "N/A";

  /* IRR (approx) */
  irr.innerText = inv>0 ? ((PAT/inv)*100).toFixed(1)+" %" : "N/A";

  /* NPV */
  let npvVal=-inv;
  for(let y=1;y<=5;y++) npvVal+=OCF/Math.pow(1+disc,y);
  npv.innerText=Math.round(npvVal);

  /* Ratios */
  let debt=int*10;
  let equity=inv-debt;
  de.innerText = equity>0?(debt/equity).toFixed(2)+" : 1":"N/A";
  icr.innerText = int>0?((EBIT)/int).toFixed(2):"тИЮ";
  cfa.innerText = (OCF/(int+inv/5)).toFixed(2);
  opm.innerText = rev>0?((EBIT/rev)*100).toFixed(1)+" %":"0 %";
  divr.innerText = (divR*100).toFixed(0)+" %";
}

calculate();
</script>

</body>
</html>
