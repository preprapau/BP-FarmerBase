<!DOCTYPE html>
<html lang="ne">
<head>
<meta charset="UTF-8">
<title>ROI Indicators | FarmerBase BP Engine</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
  font-family:"Noto Sans Devanagari","Kalimati",system-ui;
  background:#fff;
  margin:20px;
}
h2{
  color:#2e7d32;
  margin-bottom:6px;
}
.small{
  font-size:13px;
  color:#555;
  margin-bottom:14px;
}
table{
  width:100%;
  border-collapse:collapse;
  margin-top:10px;
}
th,td{
  border:1px solid #000;
  padding:8px;
  font-size:14px;
}
th{
  background:#f0f0f0;
  text-align:left;
  width:45%;
}
td{
  text-align:right;
}
.highlight{
  background:#e8f5e9;
  font-weight:700;
}
.center{
  text-align:center;
}
button{
  padding:6px 12px;
  margin-bottom:10px;
}
.note{
  margin-top:20px;
  font-size:13px;
  color:#444;
}
</style>
</head>

<body>

<h2>üìä ROI Indicators (‡§®‡§ø‡§∞‡•ç‡§£‡§Ø ‡§∏‡•Ç‡§ö‡§ï‡§æ‡§Ç‡§ï)</h2>
<button onclick="window.print()">üñ®Ô∏è Print</button>

<p class="small">
‡§Ø‡•ã ‡§∏‡•Ç‡§ö‡§ï‡§æ‡§Ç‡§ï Income, Expense ‡§§‡§•‡§æ Profit‚ÄìLoss ‡§™‡•á‡§ú‡§Æ‡§æ ‡§™‡•ç‡§∞‡§µ‡§ø‡§∑‡•ç‡§ü ‡§°‡§æ‡§ü‡§æ‡§ï‡§æ ‡§Ü‡§ß‡§æ‡§∞‡§Æ‡§æ
‡§∏‡•ç‡§µ‡§§‡§É ‡§ó‡§£‡§®‡§æ ‡§ó‡§∞‡§ø‡§è‡§ï‡•ã ‡§π‡•ã‡•§
</p>

<table>
<tbody>
<tr>
  <th>‡§™‡•ç‡§∞‡§æ‡§∞‡§Æ‡•ç‡§≠‡§ø‡§ï ‡§≤‡§ó‡§æ‡§®‡•Ä (Initial Investment)</th>
  <td id="investment">0</td>
</tr>

<tr>
  <th>‡§µ‡§æ‡§∞‡•ç‡§∑‡§ø‡§ï ‡§ï‡•Å‡§≤ ‡§Ü‡§Æ‡•ç‡§¶‡§æ‡§®‡•Ä</th>
  <td id="income">0</td>
</tr>

<tr>
  <th>‡§µ‡§æ‡§∞‡•ç‡§∑‡§ø‡§ï ‡§ï‡•Å‡§≤ ‡§ñ‡§∞‡•ç‡§ö</th>
  <td id="expense">0</td>
</tr>

<tr>
  <th>‡§µ‡§æ‡§∞‡•ç‡§∑‡§ø‡§ï ‡§∂‡•Å‡§¶‡•ç‡§ß ‡§®‡§æ‡§´‡§æ (Net Profit)</th>
  <td id="netProfit">0</td>
</tr>

<tr class="highlight">
  <th>ROI (%)</th>
  <td id="roiPercent">0</td>
</tr>

<tr>
  <th>Payback Period (‡§µ‡§∞‡•ç‡§∑)</th>
  <td id="payback">0</td>
</tr>

<tr>
  <th>Profit Margin (%)</th>
  <td id="profitMargin">0</td>
</tr>

<tr>
  <th>Capital Turnover Ratio</th>
  <td id="capitalTurnover">0</td>
</tr>
</tbody>
</table>

<div class="note">
<strong>üîç Interpretation Guide:</strong><br>
‚Ä¢ ROI 25% ‡§≠‡§®‡•ç‡§¶‡§æ ‡§Æ‡§æ‡§•‡§ø ‚Üí ‡§Ü‡§ï‡§∞‡•ç‡§∑‡§ï ‡§µ‡•ç‡§Ø‡§µ‡§∏‡§æ‡§Ø<br>
‚Ä¢ Payback 5 ‡§µ‡§∞‡•ç‡§∑‡§≠‡§®‡•ç‡§¶‡§æ ‡§ï‡§Æ ‚Üí ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§ø‡§§ ‡§≤‡§ó‡§æ‡§®‡•Ä<br>
‚Ä¢ Profit Margin ‡§â‡§ö‡•ç‡§ö ‚Üí ‡§≤‡§æ‡§ó‡§§ ‡§®‡§ø‡§Ø‡§®‡•ç‡§§‡•ç‡§∞‡§£ ‡§∞‡§æ‡§Æ‡•ç‡§∞‡•ã
</div>

<script>
/* ===== LOAD PROJECT ===== */
const key = localStorage.getItem("activeProject");
if(!key){ alert("Active ‡§Ø‡•ã‡§ú‡§®‡§æ ‡§≠‡•á‡§ü‡§ø‡§è‡§®"); }
const p = JSON.parse(localStorage.getItem(key)) || {};

/* ===== BASIC VALUES ===== */
const income = Number(p.totalIncome) || 0;
const netProfit = Number(p.netProfit) || 0;

/* Total Expense */
const expense = (p.expenses || [])
  .reduce((s,e)=>s+(Number(e.amount)||0),0);

/* Initial Investment = Fixed Cost */
const investment = (p.expenses || [])
  .filter(e=>e.category==="‡§™‡•Ç‡§∞‡•ç‡§µ‡§æ‡§ß‡§æ‡§∞ ‡§®‡§ø‡§∞‡•ç‡§Æ‡§æ‡§£" || e.category==="‡§Æ‡•á‡§∂‡§ø‡§® ‡§î‡§ú‡§æ‡§∞")
  .reduce((s,e)=>s+(Number(e.amount)||0),0);

/* ===== INDICATORS ===== */
const roi = investment>0 ? (netProfit/investment)*100 : 0;
const payback = netProfit>0 ? (investment/netProfit) : 0;
const profitMargin = income>0 ? (netProfit/income)*100 : 0;
const capitalTurnover = investment>0 ? (income/investment) : 0;

/* ===== RENDER ===== */
investment && (document.getElementById("investment").innerText = investment.toFixed(2));
document.getElementById("income").innerText = income.toFixed(2);
document.getElementById("expense").innerText = expense.toFixed(2);
document.getElementById("netProfit").innerText = netProfit.toFixed(2);
document.getElementById("roiPercent").innerText = roi.toFixed(2);
document.getElementById("payback").innerText = payback.toFixed(2);
document.getElementById("profitMargin").innerText = profitMargin.toFixed(2);
document.getElementById("capitalTurnover").innerText = capitalTurnover.toFixed(2);
</script>

</body>
</html>
