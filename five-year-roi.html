<!DOCTYPE html>
<html lang="ne">
<head>
<meta charset="UTF-8">
<title>ROI / 5-Year Projection | Farmerbase BP Engine</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
  font-family:"Noto Sans Devanagari","Kalimati",system-ui;
  background:#f4f7f6;margin:0
}
header,footer{
  background:#e8f5e9;
  padding:10px 16px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  font-size:14px
}
header a,footer a{
  text-decoration:none;
  color:#2e7d32;
  font-weight:600
}
.wrap{
  max-width:1100px;
  margin:18px auto;
  background:#fff;
  padding:22px;
  border-radius:12px
}
h2{color:#2e7d32;margin-top:0}
h3{color:#1565c0;margin-bottom:6px}

table{
  width:100%;
  border-collapse:collapse;
  margin-top:10px
}
th,td{
  border:1px solid #ccc;
  padding:6px;
  text-align:right
}
th{background:#eef5ee}
.left{text-align:left}
.sum{background:#fafafa;font-weight:700}

input{
  padding:6px;
  width:100%;
  box-sizing:border-box
}
.note{font-size:13px;color:#555}
</style>
</head>

<body>

<!-- ЁЯФЭ TOP NAV -->
<header>
  <a href="index.html">ЁЯПа Back to Home</a>
  <div>
    <a href="profit-loss-demo.html">тЧАя╕П ProfitтАУLoss</a> |
    <a href="full-proposal.html">Full Proposal тЦ╢я╕П</a>
  </div>
</header>

<div class="wrap">

<h2>ЁЯУИ ROI рд░ рел рд╡рд░реНрд╖реЗ Projection</h2>

<!-- ================= BASE SUMMARY ================= -->
<h3>ЁЯФв рдЖрдзрд╛рд░ (YearтАУ1)</h3>

<table>
<tr><th class="left">рд╡рд┐рд╡рд░рдг</th><th>рд░рдХрдо</th></tr>
<tr><td class="left">рдХреБрд▓ рдЖрдореНрджрд╛рдиреА</td><td id="income1">0</td></tr>
<tr><td class="left">рдХреБрд▓ рдЪрд╛рд▓реБ рдЦрд░реНрдЪ</td><td id="expense1">0</td></tr>
<tr class="sum"><td class="left">рд╢реБрджреНрдз рдирд╛рдлрд╛ (YearтАУ1)</td><td id="profit1">0</td></tr>
<tr><td class="left">рд╕реНрдерд┐рд░ рд▓рдЧрд╛рдиреА (Capital)</td><td id="capital">0</td></tr>
<tr class="sum"><td class="left">ROI (%)</td><td id="roi">0%</td></tr>
</table>

<hr>

<!-- ================= GROWTH INPUT ================= -->
<h3>ЁЯУК рд╡рд╛рд░реНрд╖рд┐рдХ рд╡реГрджреНрдзрд┐рджрд░ (Editable)</h3>

<table>
<tr>
  <th class="left">рд╡рд┐рд╡рд░рдг</th>
  <th>рд╡реГрджреНрдзрд┐рджрд░ % (рдкреНрд░рддрд┐ рд╡рд░реНрд╖)</th>
</tr>
<tr>
  <td class="left">рдЖрдореНрджрд╛рдиреА рд╡реГрджреНрдзрд┐рджрд░</td>
  <td><input id="incomeGrowth" value="10"></td>
</tr>
<tr>
  <td class="left">рдЦрд░реНрдЪ рд╡реГрджреНрдзрд┐рджрд░</td>
  <td><input id="expenseGrowth" value="5"></td>
</tr>
</table>

<p class="note">
тЬФя╕П рдпреЛ рджрд░ рдкрд░рд┐рд╡рд░реНрддрди рдЧрд░реНрджрд╛ Projection рд╕реНрд╡рддрдГ рдмрджрд▓рд┐рдиреНрдЫ<br>
тЬФя╕П рдЕрдиреБрджрд╛рди / рдмреИрдВрдХ рдкреНрд░рд╕реНрддрд╛рд╡рдХрд╛ рд▓рд╛рдЧрд┐ рдЙрдкрдпреЛрдЧреА
</p>

<hr>

<!-- ================= 5 YEAR PROJECTION ================= -->
<h3>ЁЯУЕ рел рд╡рд░реНрд╖реЗ Projection</h3>

<table>
<thead>
<tr>
  <th>рд╡рд░реНрд╖</th>
  <th>рдЖрдореНрджрд╛рдиреА</th>
  <th>рдЦрд░реНрдЪ</th>
  <th>рдирд╛рдлрд╛</th>
  <th>рд╕рдВрдЪрд┐рдд рдирд╛рдлрд╛</th>
</tr>
</thead>
<tbody id="projBody"></tbody>
</table>

</div>

<!-- ЁЯФ╗ BOTTOM NAV -->
<footer>
  <a href="profit-loss-demo.html">тЧАя╕П Previous</a>
  <a href="index.html">ЁЯПа Home</a>
  <a href="full-proposal.html">Next тЦ╢я╕П</a>
</footer>

<script>
/* ================= LOAD PROJECT ================= */
let key = localStorage.getItem("activeProject");
if(!key){
  alert("рдкрд╣рд┐рд▓реЗ Project рдЦреЛрд▓реНрдиреБрд╣реЛрд╕реН");
  location.href="index.html";
}
let project = JSON.parse(localStorage.getItem(key)) || {};

/* ================= CALCULATE BASE ================= */
let income=0, expense=0, capital=0;

(project.incomeData||[]).forEach(i=>{
  income += Number(i.amount)||0;
});

(project.expenseData||[]).forEach(e=>{
  if(e.mainCat==="рдЪрд╛рд▓реБ рдЦрд░реНрдЪ"){
    expense += Number(e.amount)||0;
  }
  if(e.mainCat==="рд╕реНрдерд┐рд░ рдЦрд░реНрдЪ"){
    capital += Number(e.amount)||0;
  }
});

let profit = income - expense;
let roi = capital>0 ? (profit/capital)*100 : 0;

/* DISPLAY BASE */
income1.innerText = Math.round(income);
expense1.innerText = Math.round(expense);
profit1.innerText = Math.round(profit);
capital.innerText = Math.round(capital);
roi.innerText = roi.toFixed(2) + "%";

/* ================= PROJECTION ================= */
function project5Y(){
  projBody.innerHTML="";
  let ig = Number(incomeGrowth.value)||0;
  let eg = Number(expenseGrowth.value)||0;

  let curIncome = income;
  let curExpense = expense;
  let cumProfit = 0;

  for(let y=1;y<=5;y++){
    if(y>1){
      curIncome = curIncome * (1 + ig/100);
      curExpense = curExpense * (1 + eg/100);
    }
    let p = curIncome - curExpense;
    cumProfit += p;

    projBody.innerHTML+=`
      <tr>
        <td>${y}</td>
        <td>${Math.round(curIncome)}</td>
        <td>${Math.round(curExpense)}</td>
        <td>${Math.round(p)}</td>
        <td>${Math.round(cumProfit)}</td>
      </tr>
    `;
  }
}

/* EVENTS */
incomeGrowth.oninput = project5Y;
expenseGrowth.oninput = project5Y;

/* INIT */
project5Y();
</script>

</body>
</html>
