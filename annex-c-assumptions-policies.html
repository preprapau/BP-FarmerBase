<!DOCTYPE html>
<html lang="ne">
<head>
<meta charset="UTF-8">
<title>Annex‚ÄìC : Assumptions & Policies</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
  font-family:"Noto Sans Devanagari","Kalimati","Mangal","Nirmala UI",system-ui;
  background:#eaeaea;
  margin:0;
}
.page{
  max-width:210mm;
  margin:20px auto;
  background:#fff;
  padding:25mm 20mm;
}
h1,h2,h3{
  color:#2e7d32;
  margin-top:0;
}
.small{font-size:13px;color:#555}

/* tables */
table{
  width:100%;
  border-collapse:collapse;
  margin-top:10px;
}
th,td{
  border:1px solid #444;
  padding:6px;
  font-size:13px;
}
th{background:#f1f8e9}

/* policy box */
.policy{
  border:1px solid #ccc;
  border-radius:8px;
  padding:12px;
  margin:10px 0;
  background:#fafafa;
}

/* print rules */
@media print{
  body{background:#fff}
  thead{display:table-header-group}
  tr{page-break-inside:avoid}
  h1,h2,h3{page-break-after:avoid}
  section{page-break-inside:avoid}
}
</style>
</head>

<body>

<div class="page">

<h1>üìé Annex‚ÄìC : Assumptions & Policies</h1>
<p class="small">
‡§Ø‡§∏ Annex ‡§Æ‡§æ ‡§µ‡§ø‡§§‡•ç‡§§‡•Ä‡§Ø ‡§Ö‡§®‡•Å‡§Æ‡§æ‡§®, ‡§µ‡•É‡§¶‡•ç‡§ß‡§ø ‡§¶‡§∞, ‡§Ü‡§Æ‡•ç‡§¶‡§æ‡§®‡•Ä ‡§¨‡§æ‡§Å‡§°‡§´‡§æ‡§Å‡§ü ‡§§‡§•‡§æ
‡§µ‡•ç‡§Ø‡§µ‡§∏‡§æ‡§Ø ‡§∏‡§û‡•ç‡§ö‡§æ‡§≤‡§® ‡§∏‡§Æ‡•ç‡§¨‡§®‡•ç‡§ß‡•Ä ‡§™‡•ç‡§∞‡§Æ‡•Å‡§ñ ‡§®‡•Ä‡§§‡§ø‡§ó‡§§ ‡§ß‡§æ‡§∞‡§£‡§æ‡§π‡§∞‡•Ç ‡§™‡•ç‡§∞‡§∏‡•ç‡§§‡•Å‡§§ ‡§ó‡§∞‡§ø‡§è‡§ï‡•ã ‡§õ‡•§
</p>

<hr>

<!-- ================= C1. GROWTH ASSUMPTIONS ================= -->
<section>
<h2>C1. Growth Assumptions (‡§µ‡•É‡§¶‡•ç‡§ß‡§ø ‡§Ö‡§®‡•Å‡§Æ‡§æ‡§®)</h2>

<table>
  <thead>
    <tr>
      <th>‡§µ‡§∞‡•ç‡§∑</th>
      <th>‡§Ü‡§Æ‡•ç‡§¶‡§æ‡§®‡•Ä ‡§µ‡•É‡§¶‡•ç‡§ß‡§ø %</th>
      <th>‡§ñ‡§∞‡•ç‡§ö ‡§µ‡•É‡§¶‡•ç‡§ß‡§ø %</th>
      <th>‡§ü‡§ø‡§™‡•ç‡§™‡§£‡•Ä</th>
    </tr>
  </thead>
  <tbody id="growthTable"></tbody>
</table>
</section>

<hr>

<!-- ================= C2. INCOME ALLOCATION ================= -->
<section>
<h2>C2. Income Allocation / Distribution Policy</h2>

<table>
  <thead>
    <tr>
      <th>‡§∂‡•Ä‡§∞‡•ç‡§∑‡§ï</th>
      <th>‡§™‡•ç‡§∞‡§§‡§ø‡§∂‡§§ (%)</th>
      <th>‡§â‡§¶‡•ç‡§¶‡•á‡§∂‡•ç‡§Ø</th>
    </tr>
  </thead>
  <tbody id="allocationTable"></tbody>
</table>
</section>

<hr>

<!-- ================= C3. KEY ASSUMPTIONS ================= -->
<section>
<h2>C3. Key Assumptions</h2>
<div id="assumptionNotes"></div>
</section>

<hr>

<!-- ================= C4. POLICY NOTES ================= -->
<section>
<h2>C4. Policy Notes</h2>
<div id="policyNotes"></div>
</section>

</div>

<script>
/* ===== LOAD PROJECT ===== */
const key = localStorage.getItem("activeProject");
if(!key){
  alert("Project not found");
  location.href="index.html";
}
const p = JSON.parse(localStorage.getItem(key));

/* ================= GROWTH ASSUMPTIONS ================= */
const g = p.growthAssumptions || {};
let rows = "";

if(g.mode === "same"){
  rows += `
    <tr>
      <td>Year 2 ‚Äì Year 5</td>
      <td>${g.same?.revenue ?? 0}%</td>
      <td>${g.same?.expense ?? 0}%</td>
      <td>‡§∏‡§¨‡•à ‡§µ‡§∞‡•ç‡§∑ ‡§è‡§â‡§ü‡•à ‡§µ‡•É‡§¶‡•ç‡§ß‡§ø ‡§¶‡§∞ ‡§≤‡§æ‡§ó‡•Ç</td>
    </tr>`;
}else if(Array.isArray(g.years)){
  g.years.forEach((y,i)=>{
    rows += `
      <tr>
        <td>Year ${i+2}</td>
        <td>${y.revenue ?? 0}%</td>
        <td>${y.expense ?? 0}%</td>
        <td>‡§µ‡§∞‡•ç‡§∑ ‡§Ö‡§®‡•Å‡§∏‡§æ‡§∞ ‡§´‡§∞‡§ï ‡§µ‡•É‡§¶‡•ç‡§ß‡§ø ‡§¶‡§∞</td>
      </tr>`;
  });
}else{
  rows = `<tr><td colspan="4"><i>Growth assumption ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§õ‡•à‡§®</i></td></tr>`;
}
growthTable.innerHTML = rows;

/* ================= INCOME ALLOCATION ================= */
const alloc = p.incomeAllocation || {};
let arows = "";

if(alloc.items && alloc.items.length){
  arows = alloc.items.map(i=>`
    <tr>
      <td>${i.title}</td>
      <td>${i.percent}%</td>
      <td>${i.note || ""}</td>
    </tr>
  `).join("");
}else{
  arows = `
    <tr>
      <td>‡§™‡•Å‡§®‡§É ‡§≤‡§ó‡§æ‡§®‡•Ä</td>
      <td>${alloc.reinvest ?? 0}%</td>
      <td>‡§µ‡•ç‡§Ø‡§µ‡§∏‡§æ‡§Ø ‡§µ‡§ø‡§∏‡•ç‡§§‡§æ‡§∞‡§ï‡§æ ‡§≤‡§æ‡§ó‡§ø</td>
    </tr>
    <tr>
      <td>‡§∏‡§æ‡§Æ‡•Å‡§¶‡§æ‡§Ø‡§ø‡§ï / ‡§µ‡§æ‡§§‡§æ‡§µ‡§∞‡§£</td>
      <td>${alloc.community ?? 0}%</td>
      <td>‡§∏‡§æ‡§Æ‡§æ‡§ú‡§ø‡§ï ‡§â‡§§‡•ç‡§§‡§∞‡§¶‡§æ‡§Ø‡§ø‡§§‡•ç‡§µ</td>
    </tr>
    <tr>
      <td>‡§ï‡§æ‡§Æ‡§¶‡§æ‡§∞ ‡§µ‡§ø‡§ï‡§æ‡§∏ ‡§ï‡•ã‡§∑</td>
      <td>${alloc.worker ?? 0}%</td>
      <td>‡§ï‡•ç‡§∑‡§Æ‡§§‡§æ ‡§µ‡§ø‡§ï‡§æ‡§∏ ‡§§‡§•‡§æ ‡§™‡•ç‡§∞‡•ã‡§§‡•ç‡§∏‡§æ‡§π‡§®</td>
    </tr>`;
}
allocationTable.innerHTML = arows;

/* ================= ASSUMPTION NOTES ================= */
const assumptions = p.policyAssumptions || [
  "‡§¨‡§ú‡§æ‡§∞ ‡§Æ‡•Ç‡§≤‡•ç‡§Ø ‡§π‡§æ‡§≤‡§ï‡•ã ‡§∏‡•ç‡§•‡§æ‡§®‡•Ä‡§Ø ‡§¨‡§ú‡§æ‡§∞ ‡§¶‡§∞‡§Æ‡§æ ‡§Ü‡§ß‡§æ‡§∞‡§ø‡§§ ‡§ó‡§∞‡§ø‡§è‡§ï‡•ã ‡§õ‡•§",
  "‡§ï‡§ö‡•ç‡§ö‡§æ ‡§™‡§¶‡§æ‡§∞‡•ç‡§•‡§ï‡•ã ‡§â‡§™‡§≤‡§¨‡•ç‡§ß‡§§‡§æ ‡§®‡§ø‡§Ø‡§Æ‡§ø‡§§ ‡§∞‡§π‡§®‡•á ‡§Ö‡§®‡•Å‡§Æ‡§æ‡§® ‡§ó‡§∞‡§ø‡§è‡§ï‡•ã ‡§õ‡•§",
  "‡§™‡•ç‡§∞‡§æ‡§µ‡§ø‡§ß‡§ø‡§ï ‡§§‡§•‡§æ ‡§µ‡•ç‡§Ø‡§µ‡§∏‡•ç‡§•‡§æ‡§™‡§® ‡§™‡§ï‡•ç‡§∑ ‡§∏‡•ç‡§•‡§ø‡§∞ ‡§∞‡§π‡§®‡•á ‡§Ö‡§™‡•á‡§ï‡•ç‡§∑‡§æ ‡§ó‡§∞‡§ø‡§è‡§ï‡•ã ‡§õ‡•§"
];

assumptionNotes.innerHTML = assumptions.map(a=>`
  <div class="policy">‚Ä¢ ${a}</div>
`).join("");

/* ================= POLICY NOTES ================= */
const policies = p.policyNotes || [
  "‡§≤‡•á‡§ñ‡§æ ‡§§‡§•‡§æ ‡§Ö‡§≠‡§ø‡§≤‡•á‡§ñ ‡§™‡§æ‡§∞‡§¶‡§∞‡•ç‡§∂‡•Ä ‡§∞‡•Ç‡§™‡§Æ‡§æ ‡§∞‡§æ‡§ñ‡§ø‡§®‡•á‡§õ‡•§",
  "‡§∏‡•ç‡§•‡§æ‡§®‡•Ä‡§Ø ‡§∞‡•ã‡§ú‡§ó‡§æ‡§∞‡•Ä‡§≤‡§æ‡§à ‡§™‡•ç‡§∞‡§æ‡§•‡§Æ‡§ø‡§ï‡§§‡§æ ‡§¶‡§ø‡§á‡§®‡•á‡§õ‡•§",
  "‡§™‡§∞‡•ç‡§Ø‡§æ‡§µ‡§∞‡§£‡§Æ‡•à‡§§‡•ç‡§∞‡•Ä ‡§Ö‡§≠‡•ç‡§Ø‡§æ‡§∏ ‡§Ö‡§™‡§®‡§æ‡§á‡§®‡•á‡§õ‡•§"
];

policyNotes.innerHTML = policies.map(pn=>`
  <div class="policy">‚Ä¢ ${pn}</div>
`).join("");
</script>

</body>
</html>
