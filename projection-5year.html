<!DOCTYPE html>
<html lang="ne">
<head>
<meta charset="UTF-8">
<title>5-Year Projection | FarmerBase BP Engine</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
  font-family:"Noto Sans Devanagari","Kalimati",system-ui;
  background:#f4f7f6;margin:0
}
header,footer{
  background:#e8f5e9;
  padding:10px 16px;
  display:flex;
  justify-content:space-between;
  align-items:center
}
header a,footer a{
  text-decoration:none;
  font-weight:700;
  color:#2e7d32
}
.container{
  max-width:1200px;
  margin:auto;
  padding:20px
}
h2,h3{color:#2e7d32;margin:8px 0}
.small{font-size:13px;color:#555}

.section{
  background:#fff;
  padding:16px;
  border-radius:12px;
  margin-bottom:16px
}

table{
  width:100%;
  border-collapse:collapse
}
th,td{
  border:1px solid #ccc;
  padding:6px;
  font-size:14px
}
th{background:#eef5ee}
.right{text-align:right}

.highlight{
  background:#e8f5e9;
  font-weight:700
}

.footerNav{
  display:flex;
  justify-content:space-between;
  width:100%
}

@media print{
  header, footer{display:none}
  body{background:#fff}
}
</style>
</head>

<body>

<!-- TOP NAV -->
<header>
  <a href="income-allocation.html">тмЕя╕П Income Allocation</a>
  <strong>ЁЯУЕ 5-Year Projection</strong>
  <a href="financial-ratios.html">тЮбя╕П Financial Ratios</a>
</header>

<div class="container">

<h2>рел рд╡рд░реНрд╖реЗ рд╡рд┐рддреНрддреАрдп рдкреНрд░рдХреНрд╖реЗрдкрдг (Projection)</h2>
<p class="small">
тД╣я╕П Year-1 рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдбрд╛рдЯрд╛ рд╣реЛред  
Year-2 рджреЗрдЦрд┐ Growth Assumptions рд▓рд╛рдЧреВ рдЧрд░рд┐рдПрдХреЛ рдЫред
</p>

<!-- PROJECTION TABLE -->
<div class="section">
<h3>ЁЯУК рдЖрдореНрджрд╛рдиреА, рдЦрд░реНрдЪ рд░ рдирдЧрдж рдкреНрд░рд╡рд╛рд╣</h3>

<table>
<thead>
<tr>
  <th>рд╡рд░реНрд╖</th>
  <th class="right">рдЖрдореНрджрд╛рдиреА (рд░реБ)</th>
  <th class="right">рдЦрд░реНрдЪ (рд░реБ)</th>
  <th class="right">рд╢реБрджреНрдз рдирдЧрдж рдкреНрд░рд╡рд╛рд╣</th>
</tr>
</thead>
<tbody id="rows"></tbody>
<tfoot>
<tr class="highlight">
  <th>рел рд╡рд░реНрд╖реЗ рдЬрдореНрдорд╛</th>
  <th class="right" id="sumIncome">0</th>
  <th class="right" id="sumExpense">0</th>
  <th class="right" id="sumCash">0</th>
</tr>
</tfoot>
</table>
</div>

<!-- CASH FLOW NOTE -->
<div class="section">
<h3>ЁЯУЭ рдЯрд┐рдкреНрдкрдгреА</h3>
<p class="small">
рдпреЛ рдкреНрд░рдХреНрд╖реЗрдкрдг Growth Assumptions рдкреЗрдЬрдорд╛ рдкреНрд░рд╡рд┐рд╖реНрдЯ рдЧрд░рд┐рдПрдХреЛ
рд╡реГрджреНрдзрд┐ рдкреНрд░рддрд┐рд╢рддрдХреЛ рдЖрдзрд╛рд░рдорд╛ рддрдпрд╛рд░ рдЧрд░рд┐рдПрдХреЛ рд╣реЛред
</p>
</div>

</div>

<!-- FOOTER -->
<footer>
  <div class="footerNav">
    <a href="income-allocation.html">тмЕя╕П Income Allocation</a>
    <span class="small">FarmerBase BP Engine тАУ 5-Year Projection</span>
    <a href="financial-ratios.html">тЮбя╕П Financial Ratios</a>
  </div>
</footer>

<script>
/* ===============================
   5-YEAR PROJECTION тАУ FINAL
   =============================== */

const key = localStorage.getItem("activeProject");
if(!key){ alert("Active рдпреЛрдЬрдирд╛ рднреЗрдЯрд┐рдПрди"); }

const project = JSON.parse(localStorage.getItem(key)) || {};

// -------- Year-1 Base --------
let baseIncome = 0;
(project.income||[]).forEach(i=>{
  baseIncome += (i.sellingRate||0) * (i.qty||0);
});

let baseExpense = 0;
(project.expenses||[]).forEach(e=>{
  baseExpense += e.amount||0);
});

// -------- Growth --------
const G = project.growthAssumptions || {
  mode:"same",
  same:{revenue:0,expense:0},
  years:[]
};

let income = baseIncome;
let expense = baseExpense;

let totalInc=0,totalExp=0,totalCash=0;

for(let y=1;y<=5;y++){
  let gRev=0,gExp=0;

  if(y>1){
    if(G.mode==="same"){
      gRev = G.same.revenue||0;
      gExp = G.same.expense||0;
    }else{
      const row = G.years[y-2]||{};
      gRev = row.revenue||0;
      gExp = row.expense||0;
    }
    income = income * (1 + gRev/100);
    expense = expense * (1 + gExp/100);
  }

  const cash = income - expense;

  totalInc += income;
  totalExp += expense;
  totalCash += cash;

  rows.innerHTML += `
  <tr>
    <td>Year ${y}</td>
    <td class="right">${income.toLocaleString()}</td>
    <td class="right">${expense.toLocaleString()}</td>
    <td class="right">${cash.toLocaleString()}</td>
  </tr>`;
}

sumIncome.innerText = totalInc.toLocaleString();
sumExpense.innerText = totalExp.toLocaleString();
sumCash.innerText = totalCash.toLocaleString();
</script>

</body>
</html>
