<!DOCTYPE html>
<html lang="ne">
<head>
<meta charset="UTF-8">
<title>Annex‚ÄìB : Existing Status & Evidence</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
  font-family:"Noto Sans Devanagari","Kalimati","Mangal","Nirmala UI",system-ui;
  background:#eaeaea;
  margin:0;
}
.page{
  max-width:210mm;
  margin:20px auto;
  background:#fff;
  padding:25mm 20mm;
}
h1,h2,h3{
  color:#2e7d32;
  margin-top:0;
}
.small{font-size:13px;color:#555}

/* cards */
.card{
  border:1px solid #ccc;
  border-radius:8px;
  padding:12px;
  margin:10px 0;
}
.card img{
  max-width:100%;
  border-radius:6px;
  margin-top:6px;
}

/* checklist table */
table{
  width:100%;
  border-collapse:collapse;
  margin-top:10px;
}
th,td{
  border:1px solid #444;
  padding:6px;
  font-size:13px;
}
th{background:#f1f8e9}
.yes{color:#2e7d32;font-weight:bold}
.no{color:#c62828;font-weight:bold}

/* print rules */
@media print{
  body{background:#fff}
  h1,h2,h3{page-break-after:avoid}
  .card{page-break-inside:avoid}
  table{page-break-inside:auto}
  tr{page-break-inside:avoid}
}
</style>
</head>

<body>

<div class="page">

<h1>üìé Annex‚ÄìB : Existing Status & Evidence</h1>
<p class="small">
‡§Ø‡§∏ Annex ‡§Æ‡§æ ‡§∏‡§Ç‡§∏‡•ç‡§•‡§æ‡§≤‡•á ‡§Ø‡§∏‡§Ö‡§ò‡§ø ‡§ó‡§∞‡•á‡§ï‡§æ ‡§ï‡§æ‡§∞‡•ç‡§Ø‡§π‡§∞‡•Ç, ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§™‡•Ç‡§∞‡•ç‡§µ‡§æ‡§ß‡§æ‡§∞,
‡§§‡§Ø‡§æ‡§∞‡•Ä ‡§Ö‡§µ‡§∏‡•ç‡§•‡§æ ‡§§‡§•‡§æ ‡§™‡•ç‡§∞‡§Æ‡§æ‡§£‡§π‡§∞‡•Ç ‡§™‡•ç‡§∞‡§∏‡•ç‡§§‡•Å‡§§ ‡§ó‡§∞‡§ø‡§è‡§ï‡•ã ‡§õ‡•§
</p>

<hr>

<!-- ================= B1. PAST WORKS ================= -->
<h2>B1. ‡§Ø‡§∏‡§Ö‡§ò‡§ø ‡§ó‡§∞‡§ø‡§è‡§ï‡§æ ‡§ï‡§æ‡§∞‡•ç‡§Ø‡§π‡§∞‡•Ç (Past Works)</h2>
<div id="pastWorks"></div>

<hr>

<!-- ================= B2. CHECKLIST ================= -->
<h2>B2. ‡§™‡•Ç‡§∞‡•ç‡§µ‡§æ‡§ß‡§æ‡§∞ / ‡§§‡§Ø‡§æ‡§∞‡•Ä ‡§Ö‡§µ‡§∏‡•ç‡§•‡§æ Checklist</h2>

<table>
  <thead>
    <tr>
      <th style="width:70%">‡§µ‡§ø‡§µ‡§∞‡§£</th>
      <th style="width:30%">‡§∏‡•ç‡§•‡§ø‡§§‡§ø</th>
    </tr>
  </thead>
  <tbody id="checklistTable"></tbody>
</table>

<hr>

<!-- ================= B3. SUMMARY ================= -->
<h2>B3. Readiness Summary</h2>
<p id="readinessSummary"></p>

</div>

<script>
/* ===== LOAD PROJECT ===== */
const key = localStorage.getItem("activeProject");
if(!key){
  alert("Project not found");
  location.href="index.html";
}
const p = JSON.parse(localStorage.getItem(key));

/* ================= PAST WORKS ================= */
const works = p.existingStatus?.works || [];
if(!works.length){
  pastWorks.innerHTML = "<i>‡§ï‡•Å‡§®‡•à ‡§ï‡§æ‡§∞‡•ç‡§Ø ‡§µ‡§ø‡§µ‡§∞‡§£ ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§õ‡•à‡§®</i>";
}else{
  pastWorks.innerHTML = works.map((w,i)=>`
    <div class="card">
      <h3>${i+1}. ${w.topic}</h3>
      <p>${w.content}</p>
      ${w.photo ? `<img src="${w.photo}">` : ""}
    </div>
  `).join("");
}

/* ================= CHECKLIST ================= */
const checklist = p.existingStatus?.checklist || [];
let yesCount = 0;

if(!checklist.length){
  checklistTable.innerHTML = `
    <tr><td colspan="2"><i>Checklist ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§õ‡•à‡§®</i></td></tr>`;
}else{
  checklistTable.innerHTML = checklist.map(c=>{
    if(c.checked) yesCount++;
    return `
      <tr>
        <td>${c.text}</td>
        <td class="${c.checked?'yes':'no'}">
          ${c.checked ? '‡§õ' : '‡§õ‡•à‡§®'}
        </td>
      </tr>`;
  }).join("");
}

/* ================= SUMMARY ================= */
if(checklist.length){
  const percent = Math.round((yesCount / checklist.length) * 100);
  readinessSummary.innerText =
    `‡§â‡§™‡§≤‡§¨‡•ç‡§ß ${checklist.length} ‡§Æ‡§ß‡•ç‡§Ø‡•á ${yesCount} ‡§™‡•Ç‡§∞‡•ç‡§µ‡§æ‡§ß‡§æ‡§∞/‡§§‡§Ø‡§æ‡§∞‡•Ä ‡§Ö‡§µ‡§∏‡•ç‡§•‡§æ ‡§™‡•Ç‡§∞‡§æ ‡§≠‡§è‡§ï‡•ã ‡§õ‡•§
     ‡§Ø‡§∏ ‡§Ü‡§ß‡§æ‡§∞‡§Æ‡§æ ‡§∏‡§Ç‡§∏‡•ç‡§•‡§æ‡§ï‡•ã ‡§∏‡§Æ‡§ó‡•ç‡§∞ ‡§§‡§Ø‡§æ‡§∞‡•Ä ‡§Ö‡§µ‡§∏‡•ç‡§•‡§æ ‡§ï‡§∞‡§ø‡§¨ ${percent}% ‡§∞‡§π‡•á‡§ï‡•ã ‡§¶‡•á‡§ñ‡§ø‡§®‡•ç‡§õ‡•§`;
}else{
  readinessSummary.innerText = "‡§§‡§Ø‡§æ‡§∞‡•Ä ‡§Ö‡§µ‡§∏‡•ç‡§•‡§æ ‡§Æ‡•Ç‡§≤‡•ç‡§Ø‡§æ‡§ô‡•ç‡§ï‡§®‡§ï‡§æ ‡§≤‡§æ‡§ó‡§ø ‡§™‡§∞‡•ç‡§Ø‡§æ‡§™‡•ç‡§§ ‡§°‡§æ‡§ü‡§æ ‡§õ‡•à‡§®‡•§";
}
</script>

</body>
</html>
