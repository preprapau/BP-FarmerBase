<!DOCTYPE html>
<html lang="ne">
<head>
<meta charset="UTF-8">
<title>рд╡реНрдпрд╡рд╕рд╛рдпрд┐рдХ рдкреНрд░рд╕реНрддрд╛рд╡ | FarmerBase BP Engine</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
/* ================= BASE ================= */
body{
  font-family:"Noto Sans Devanagari","Kalimati","Mangal","Nirmala UI",system-ui;
  background:#eaeaea;
  margin:0;
}
.page{
  max-width:210mm;
  margin:20px auto;
  background:#fff;
  padding:25mm 20mm;
}
h1,h2,h3{
  color:#2e7d32;
  margin-top:0;
}
.small{font-size:13px;color:#555}

/* ===== SCREEN NAV (PRINT рдорд╛ рдирджреЗрдЦрд┐рдиреЗ) ===== */
.topBar{
  display:flex;
  justify-content:space-between;
  margin-bottom:12px;
}
.topBar button{
  padding:6px 14px;
  border:none;
  border-radius:6px;
  background:#2e7d32;
  color:#fff;
  cursor:pointer;
}

/* ===== TABLE ===== */
table{
  width:100%;
  border-collapse:collapse;
  margin-top:10px;
}
th,td{
  border:1px solid #444;
  padding:6px;
  font-size:13px;
}
th{background:#f1f8e9}
.total-row{
  font-weight:bold;
  background:#e8f5e9;
}

/* ===== PRINT RULES (CRITICAL) ===== */
@media print{
  body{background:#fff}
  .topBar{display:none}

  @page{ margin:20mm; }

  thead{display:table-header-group}
  tfoot{display:table-footer-group}

  tr{
    page-break-inside:avoid;
    break-inside:avoid;
  }
  h1,h2,h3{
    page-break-after:avoid;
  }
  section{
    page-break-inside:avoid;
  }
  .no-break{
    page-break-inside:avoid;
  }

  footer{
    position:fixed;
    bottom:10mm;
    right:20mm;
    font-size:12px;
  }
}

.hr{border-top:1px solid #ddd;margin:14px 0}
</style>
</head>

<body>

<div class="page">

<!-- ===== SCREEN CONTROLS ===== -->
<div class="topBar">
  <button onclick="location.href='executive-summary.html'">тмЕ Back</button>
  <button onclick="window.print()">ЁЯЦи Print / PDF</button>
</div>

<!-- ================= COVER ================= -->
<section>
  <h1>рд╡реНрдпрд╡рд╕рд╛рдпрд┐рдХ рдкреНрд░рд╕реНрддрд╛рд╡</h1>
  <p class="small" id="coverInfo"></p>
</section>

<div class="hr"></div>

<!-- ================= ToC (NEPALI) ================= -->
<section class="no-break">
  <h2>рд╡рд┐рд╖рдпрд╕реВрдЪреА</h2>
  <ol style="list-style-type: devanagari;">
    <li>рдХрд╛рд░реНрдпрдХрд╛рд░реА рд╕рд╛рд░рд╛рдВрд╢</li>
    <li>рд╣рд╛рд▓рдХреЛ рдЕрд╡рд╕реНрдерд╛</li>
    <li>рд╕рдВрдХреНрд╖рд┐рдкреНрдд рд╡рд┐рд╢реНрд▓реЗрд╖рдг</li>
    <li>рд╡реНрдпрд╡рд╕рд╛рдп рд╡рд┐рд╡рд░рдг рддрдерд╛ рд╕рдЮреНрдЪрд╛рд▓рди рдпреЛрдЬрдирд╛</li>
    <li>рдЙрддреНрдкрд╛рджрди рдпреЛрдЬрдирд╛ (рд╕рд╛рд░рд╛рдВрд╢)</li>
    <li>рд▓рд╛рдЧрдд рддрдерд╛ рдЦрд░реНрдЪ рд╡рд┐рд╡рд░рдг (рд╕рд╛рд░рд╛рдВрд╢)</li>
    <li>рдЖрдореНрджрд╛рдиреА рддрдерд╛ рдирд╛рдлрд╛ рд╡рд┐рд╡рд░рдг (рд╕рд╛рд░рд╛рдВрд╢)</li>
    <li>рд╡рд┐рддреНрддреАрдп рдкреНрд░рдХреНрд╖реЗрдкрдг рддрдерд╛ рдкреНрд░рддрд┐рдлрд▓ (ROI)</li>
    <li>рд╡реГрджреНрдзрд┐ рдЕрдиреБрдорд╛рди</li>
    <li>рд╡рд┐рддреНрддреАрдп рдЕрдиреБрдкрд╛рддрд╣рд░реВ</li>
    <li>рдЖрдореНрджрд╛рдиреА рдмрд╛рдБрдбрдлрд╛рдБрдЯ рдиреАрддрд┐</li>
    <li>рдкреНрд░рд╕реНрддрд╛рд╡ рд╡рд┐рд╡рд░рдг</li>
    <li>рдкрд░рд┐рд╢рд┐рд╖реНрдЯ</li>
  </ol>

  <h3>рдкрд░рд┐рд╢рд┐рд╖реНрдЯ</h3>
  <ul style="list-style:none;padding-left:18px">
    <li>рдХ. рдкрд░рд┐рд╢рд┐рд╖реНрдЯтАУрдХ : рд╡рд┐рддреНрддреАрдп рддрд╛рд▓рд┐рдХрд╛рд╣рд░реВ</li>
    <li>рдЦ. рдкрд░рд┐рд╢рд┐рд╖реНрдЯтАУрдЦ : рд╣рд╛рд▓рдХреЛ рдЕрд╡рд╕реНрдерд╛ рддрдерд╛ рдкреНрд░рдорд╛рдгрд╣рд░реВ</li>
    <li>рдЧ. рдкрд░рд┐рд╢рд┐рд╖реНрдЯтАУрдЧ : рдЕрдиреБрдорд╛рди рддрдерд╛ рдиреАрддрд┐рд╣рд░реВ</li>
  </ul>
</section>

<div class="hr"></div>

<!-- ================= CONTENT ================= -->
<section>
  <h2>рез. рдХрд╛рд░реНрдпрдХрд╛рд░реА рд╕рд╛рд░рд╛рдВрд╢</h2>
  <div id="execSummary"></div>
</section>

<section>
  <h2>реи. рд╣рд╛рд▓рдХреЛ рдЕрд╡рд╕реНрдерд╛</h2>
  <div id="existingStatus"></div>
</section>

<section>
  <h2>рей. рд╕рдВрдХреНрд╖рд┐рдкреНрдд рд╡рд┐рд╢реНрд▓реЗрд╖рдг</h2>
  <p id="shortAnalysis"></p>
</section>

<section>
  <h2>рек. рд╡реНрдпрд╡рд╕рд╛рдп рд╡рд┐рд╡рд░рдг рддрдерд╛ рд╕рдЮреНрдЪрд╛рд▓рди рдпреЛрдЬрдирд╛</h2>
  <div id="businessDetail"></div>
</section>

<section>
  <h2>рел. рдЙрддреНрдкрд╛рджрди рдпреЛрдЬрдирд╛ (рд╕рд╛рд░рд╛рдВрд╢)</h2>
  <p class="small">рд╡рд┐рд╕реНрддреГрдд рдЙрддреНрдкрд╛рджрди рддрд╛рд▓рд┐рдХрд╛ рдкрд░рд┐рд╢рд┐рд╖реНрдЯтАУрдХ рдорд╛ рд╕рдорд╛рд╡реЗрд╢ рдЧрд░рд┐рдПрдХреЛ рдЫред</p>
</section>

<section>
  <h2>рем. рд▓рд╛рдЧрдд рддрдерд╛ рдЦрд░реНрдЪ рд╡рд┐рд╡рд░рдг (рд╕рд╛рд░рд╛рдВрд╢)</h2>
  <p class="small">рд╡рд┐рд╕реНрддреГрдд рд▓рд╛рдЧрдд рддрд╛рд▓рд┐рдХрд╛ рдкрд░рд┐рд╢рд┐рд╖реНрдЯтАУрдХ рдорд╛ рдЙрдкрд▓рдмреНрдз рдЫред</p>
</section>

<section>
  <h2>рен. рдЖрдореНрджрд╛рдиреА рддрдерд╛ рдирд╛рдлрд╛ рд╡рд┐рд╡рд░рдг (рд╕рд╛рд░рд╛рдВрд╢)</h2>
  <p class="small">рдЖрдореНрджрд╛рдиреА рд╡рд┐рд╡рд░рдг рдкрд░рд┐рд╢рд┐рд╖реНрдЯтАУрдХ рдорд╛ рдкреНрд░рд╕реНрддреБрдд рдЧрд░рд┐рдПрдХреЛ рдЫред</p>
</section>

<section>
  <h2>рео. рд╡рд┐рддреНрддреАрдп рдкреНрд░рдХреНрд╖реЗрдкрдг рддрдерд╛ рдкреНрд░рддрд┐рдлрд▓ (ROI)</h2>
  <p class="small">ProfitтАУLoss, Cash Flow рддрдерд╛ ROI рд╡рд┐рд╡рд░рдг рдкрд░рд┐рд╢рд┐рд╖реНрдЯтАУрдХ рдорд╛ рдЫред</p>
</section>

<section>
  <h2>реп. рд╡реГрджреНрдзрд┐ рдЕрдиреБрдорд╛рди</h2>
  <pre id="growthData"></pre>
</section>

<section>
  <h2>резреж. рд╡рд┐рддреНрддреАрдп рдЕрдиреБрдкрд╛рддрд╣рд░реВ</h2>
  <pre id="ratioData"></pre>
</section>

<section>
  <h2>резрез. рдЖрдореНрджрд╛рдиреА рдмрд╛рдБрдбрдлрд╛рдБрдЯ рдиреАрддрд┐</h2>
  <pre id="allocationData"></pre>
</section>

<section>
  <h2>резреи. рдкреНрд░рд╕реНрддрд╛рд╡ рд╡рд┐рд╡рд░рдг</h2>
  <p id="proposalNarration"></p>
</section>

<section class="no-break">
  <h2>рдкрд░рд┐рд╢рд┐рд╖реНрдЯ</h2>
  <p class="small">
    рд╡рд┐рд╕реНрддреГрдд рддрд╛рд▓рд┐рдХрд╛, рдкреНрд░рдорд╛рдг рддрдерд╛ рдиреАрддрд┐рдЧрдд рд╡рд┐рд╡рд░рдгрд╣рд░реВ
    рдкрд░рд┐рд╢рд┐рд╖реНрдЯтАУрдХ, рдЦ рд░ рдЧ рдорд╛ рдкреНрд░рд╕реНрддреБрдд рдЧрд░рд┐рдПрдХреЛ рдЫред
  </p>
</section>

<!-- ================= SIGNATURE ================= -->
<section style="page-break-before:always">
  <h2>рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рддрдерд╛ рд╕реНрд╡реАрдХреГрддрд┐</h2>
  <table style="width:100%;border:none">
    <tr>
      <td style="border:none">
        .................................<br>
        рдкреНрд░рд╕реНрддрд╛рд╡рдХрдХреЛ рд╣рд╕реНрддрд╛рдХреНрд╖рд░<br>
        рдирд╛рдо:<br>
        рдорд┐рддрд┐:
      </td>
      <td style="border:none;text-align:right">
        .................................<br>
        рд╕рдВрд╕реНрдерд╛ рдкреНрд░рдореБрдЦ / рдореБрд╣рд░<br>
        рдирд╛рдо:<br>
        рдорд┐рддрд┐:
      </td>
    </tr>
  </table>
</section>

<footer>Page</footer>

</div>

<script>
/* ===== LOAD PROJECT ===== */
const key = localStorage.getItem("activeProject");
if(!key){
  alert("Project рднреЗрдЯрд┐рдПрди");
  location.href="index.html";
}
const p = JSON.parse(localStorage.getItem(key)) || {};
const si = p.shortInfo || {};

document.getElementById("coverInfo").innerText =
`${si.bp_name || "тАФ"} | ${si.bp_location || "тАФ"}
рдкреНрд░рд╕реНрддрд╛рд╡рдХрд░реНрддрд╛: ${si.bp_org || "тАФ"}`;

document.getElementById("execSummary").innerText = p.executiveSummary || "";
document.getElementById("shortAnalysis").innerText = p.shortAnalysis || "";
document.getElementById("proposalNarration").innerText = p.proposalNarration || "";

if(p.existingStatus?.works?.length){
  existingStatus.innerHTML =
    p.existingStatus.works.map((w,i)=>`${i+1}. ${w.topic} тАФ ${w.content}`).join("<br>");
}

if(Array.isArray(p.businessDetail)){
  businessDetail.innerHTML =
    p.businessDetail.map((b,i)=>`${i+1}. ${b.topic}: ${b.content}`).join("<br>");
}

growthData.innerText = JSON.stringify(p.growthAssumptions||{},null,2);
ratioData.innerText = JSON.stringify(p.financialRatios||{},null,2);
allocationData.innerText = JSON.stringify(p.incomeAllocation||{},null,2);
</script>

</body>
</html>
