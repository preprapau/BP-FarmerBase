<!DOCTYPE html>
<html lang="ne">
<head>
<meta charset="UTF-8">
<title>Full Proposal | FarmerBase BP Engine</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
/* ================= SCREEN BASE ================= */
body{
  font-family:"Noto Sans Devanagari","Kalimati","Mangal","Nirmala UI",system-ui;
  background:#eaeaea;
  margin:0;
}
.page{
  max-width:210mm;           /* A4 width */
  margin:20px auto;
  background:#fff;
  padding:25mm 20mm;         /* Print-safe margins */
}
h1,h2,h3{color:#2e7d32;margin-top:0}
.small{font-size:13px;color:#555}

/* ===== SCREEN TOP BAR (hidden in print) ===== */
.topBar{
  display:flex;
  justify-content:space-between;
  gap:10px;
  margin-bottom:12px;
}
.topBar button{
  padding:6px 14px;
  border:none;
  border-radius:6px;
  background:#2e7d32;
  color:#fff;
  cursor:pointer;
}

/* ===== TABLE (generic) ===== */
table{
  width:100%;
  border-collapse:collapse;
  margin-top:10px;
}
th,td{
  border:1px solid #444;
  padding:6px;
  font-size:13px;
}
th{background:#f1f8e9}
.total-row{
  font-weight:bold;
  background:#e8f5e9;
}

/* ===== PRINT RULES (CRITICAL) ===== */
@media print{
  body{background:#fff}
  .topBar{display:none}

  @page{ margin:20mm; }

  /* Repeat headers/footers on page breaks */
  thead{ display:table-header-group; }
  tfoot{ display:table-footer-group; }

  /* Avoid awkward splits */
  tr{ page-break-inside:avoid; break-inside:avoid; }
  h1,h2,h3{ page-break-after:avoid; }
  section{ page-break-inside:avoid; }
  .no-break{ page-break-inside:avoid; }

  /* Footer page number (browser-limited but bank-acceptable) */
  footer{
    position:fixed;
    bottom:10mm;
    right:20mm;
    font-size:12px;
  }
}

/* Utility */
.hr{border-top:1px solid #ddd;margin:14px 0}
</style>
</head>

<body>

<div class="page" id="page">

<!-- ===== SCREEN NAV (ONLY FOR VIEW) ===== -->
<div class="topBar">
  <button onclick="location.href='executive-summary.html'">тмЕ Back</button>
  <button onclick="window.print()">ЁЯЦи Print / PDF</button>
</div>

<!-- ================= COVER ================= -->
<section>
  <h1>рд╡реНрдпрд╡рд╕рд╛рдпрд┐рдХ рдкреНрд░рд╕реНрддрд╛рд╡ (Business Proposal)</h1>
  <p class="small" id="coverInfo"></p>
</section>

<div class="hr"></div>

<!-- ================= TOC ================= -->
<section class="no-break">
  <h2>Table of Contents</h2>
  <ol>
    <li>Executive Summary</li>
    <li>Existing Status</li>
    <li>Short Analysis</li>
    <li>Business Detail</li>
    <li>Production Plan (Summary)</li>
    <li>Cost & Expense Summary</li>
    <li>Income & Profit Summary</li>
    <li>Financial Projection & ROI</li>
    <li>Growth Assumptions</li>
    <li>Financial Ratios</li>
    <li>Income Allocation</li>
    <li>Proposal Narration</li>
    <li>Annex (A/B/C)</li>
  </ol>
</section>

<div class="hr"></div>

<!-- ================= 1. EXECUTIVE SUMMARY ================= -->
<section>
  <h2>1. Executive Summary</h2>
  <div id="execSummary"></div>
</section>

<!-- ================= 2. EXISTING STATUS ================= -->
<section>
  <h2>2. Existing Status</h2>
  <div id="existingStatus"></div>
</section>

<!-- ================= 3. SHORT ANALYSIS ================= -->
<section>
  <h2>3. Short Analysis</h2>
  <p id="shortAnalysis"></p>
</section>

<!-- ================= 4. BUSINESS DETAIL ================= -->
<section>
  <h2>4. Business Detail</h2>
  <div id="businessDetail"></div>
</section>

<!-- ================= 5. PRODUCTION (SUMMARY) ================= -->
<section>
  <h2>5. Production Plan (Summary)</h2>
  <p class="small">
    рд╡рд┐рд╕реНрддреГрдд рдЙрддреНрдкрд╛рджрди рддрд╛рд▓рд┐рдХрд╛ AnnexтАУA рдорд╛ рд╕рдорд╛рд╡реЗрд╢ рдЧрд░рд┐рдПрдХреЛ рдЫред
  </p>
  <div id="productionSummary"></div>
</section>

<!-- ================= 6. COST & EXPENSE (SUMMARY) ================= -->
<section>
  <h2>6. Cost & Expense Summary</h2>
  <p class="small">
    рд╡рд┐рд╕реНрддреГрдд рдЦрд░реНрдЪ рддрдерд╛ рд▓рд╛рдЧрдд рддрд╛рд▓рд┐рдХрд╛ AnnexтАУA рдорд╛ рдЙрдкрд▓рдмреНрдз рдЫред
  </p>
  <div id="costSummary"></div>
</section>

<!-- ================= 7. INCOME (SUMMARY) ================= -->
<section>
  <h2>7. Income & Profit Summary</h2>
  <p class="small">
    рдореВрд▓реНрдп рдирд┐рд░реНрдзрд╛рд░рдг рд░ рдЖрдореНрджрд╛рдиреА рд╡рд┐рд╡рд░рдг AnnexтАУA рдорд╛ рд╕рдорд╛рд╡реЗрд╢ рдЧрд░рд┐рдПрдХреЛ рдЫред
  </p>
  <div id="incomeSummary"></div>
</section>

<!-- ================= 8. ROI / PROJECTION (SUMMARY) ================= -->
<section>
  <h2>8. Financial Projection & ROI</h2>
  <p class="small">
    ProfitтАУLoss, Cash Flow, ROI/Break-even рдХреЛ рд╡рд┐рд╕реНрддреГрдд рддрд╛рд▓рд┐рдХрд╛ AnnexтАУA рдорд╛ рдЫред
  </p>
  <div id="roiSummary"></div>
</section>

<!-- ================= 9. GROWTH ASSUMPTIONS ================= -->
<section>
  <h2>9. Growth Assumptions</h2>
  <div id="growthData"></div>
</section>

<!-- ================= 10. FINANCIAL RATIOS ================= -->
<section>
  <h2>10. Financial Ratios</h2>
  <div id="ratioData"></div>
</section>

<!-- ================= 11. INCOME ALLOCATION ================= -->
<section>
  <h2>11. Income Allocation</h2>
  <div id="allocationData"></div>
</section>

<!-- ================= 12. PROPOSAL NARRATION ================= -->
<section>
  <h2>12. Proposal Narration</h2>
  <p id="proposalNarration"></p>
</section>

<!-- ================= ANNEX NOTE ================= -->
<section class="no-break">
  <h2>Annex</h2>
  <p class="small">
    рд╡рд┐рд╕реНрддреГрдд рддрд╛рд▓рд┐рдХрд╛, рдкреНрд░рдорд╛рдг рддрдерд╛ рдиреАрддрд┐рдЧрдд рд╡рд┐рд╡рд░рдгрд╣рд░реВ AnnexтАУA (Financial Tables),
    AnnexтАУB (Existing Status & Evidence) рд░ AnnexтАУC (Assumptions & Policies)
    рдорд╛ рдкреНрд░рд╕реНрддреБрдд рдЧрд░рд┐рдПрдХреЛ рдЫред
  </p>
</section>

<!-- ================= SIGNATURE ================= -->
<section style="page-break-before:always">
  <h2>Signature & Approval</h2>
  <table style="width:100%;border:none">
    <tr>
      <td style="border:none">
        .................................<br>
        рдкреНрд░рд╕реНрддрд╛рд╡рдХрдХреЛ рд╣рд╕реНрддрд╛рдХреНрд╖рд░<br>
        рдирд╛рдо:<br>
        рдорд┐рддрд┐:
      </td>
      <td style="border:none;text-align:right">
        .................................<br>
        рд╕рдВрд╕реНрдерд╛ рдкреНрд░рдореБрдЦ / рдореБрд╣рд░<br>
        рдирд╛рдо:<br>
        рдорд┐рддрд┐:
      </td>
    </tr>
  </table>
</section>

<footer>Page</footer>

</div>

<script>
/* ================= LOAD PROJECT ================= */
const key = localStorage.getItem("activeProject");
if(!key){
  alert("Project not found");
  location.href="index.html";
}
const p = JSON.parse(localStorage.getItem(key)) || {};

/* ================= COVER ================= */
const si = p.shortInfo || {};
document.getElementById("coverInfo").innerText =
`${si.bp_name || "тАФ"} | ${si.bp_location || "тАФ"}
рдкреНрд░рд╕реНрддрд╛рд╡рдХрд░реНрддрд╛: ${si.bp_org || "тАФ"}`;

/* ================= CONTENT MAP ================= */
document.getElementById("execSummary").innerText = p.executiveSummary || "";
document.getElementById("shortAnalysis").innerText = p.shortAnalysis || "";
document.getElementById("proposalNarration").innerText = p.proposalNarration || "";

/* Existing Status (concise) */
if(p.existingStatus?.works?.length){
  document.getElementById("existingStatus").innerHTML =
    p.existingStatus.works.map((w,i)=>`${i+1}. ${w.topic} тАФ ${w.content}`).join("<br>");
}else{
  document.getElementById("existingStatus").innerHTML = "<i>рд╡рд┐рд╡рд░рдг рдЙрдкрд▓рдмреНрдз рдЫреИрди</i>";
}

/* Business Detail (concise) */
if(Array.isArray(p.businessDetail) && p.businessDetail.length){
  document.getElementById("businessDetail").innerHTML =
    p.businessDetail.map((b,i)=>`${i+1}. ${b.topic}: ${b.content}`).join("<br>");
}else{
  document.getElementById("businessDetail").innerHTML = "<i>рд╡рд┐рд╡рд░рдг рдЙрдкрд▓рдмреНрдз рдЫреИрди</i>";
}

/* Lightweight summaries (heavy tables go to AnnexтАУA) */
document.getElementById("productionSummary").innerText =
  "рдЙрддреНрдкрд╛рджрдирдХреЛ рдкреНрд░рдХрд╛рд░, рдкрд░рд┐рдорд╛рдг рд░ рдПрдХрд╛рдЗ рдЕрдиреБрд╕рд╛рд░ рдпреЛрдЬрдирд╛ рдмрдирд╛рдЗрдПрдХреЛ рдЫред";

document.getElementById("costSummary").innerText =
  "рд╕рдЮреНрдЪрд╛рд▓рди рддрдерд╛ рдЙрддреНрдкрд╛рджрди рд▓рд╛рдЧрдд рд╕рдВрд░рдЪрдирд╛ рд╡реНрдпрд╡рд╕реНрдерд┐рдд рдЧрд░рд┐рдПрдХреЛ рдЫред";

document.getElementById("incomeSummary").innerText =
  "рдореВрд▓реНрдп рдирд┐рд░реНрдзрд╛рд░рдг рд░ рдирд╛рдлрд╛ рдкреНрд░рддрд┐рд╢рддрдХрд╛ рдЖрдзрд╛рд░рдорд╛ рдЖрдореНрджрд╛рдиреА рдкреНрд░рдХреНрд╖реЗрдкрдг рдЧрд░рд┐рдПрдХреЛ рдЫред";

document.getElementById("roiSummary").innerText =
  "рд╡рд┐рддреНрддреАрдп рдкреНрд░рдХреНрд╖реЗрдкрдгрдЕрдиреБрд╕рд╛рд░ ROI рддрдерд╛ Break-even рд╕рдореНрднрд╛рд╡реНрдп рджреЗрдЦрд┐рдиреНрдЫред";

/* Growth / Ratios / Allocation (print-friendly text) */
document.getElementById("growthData").innerText =
  JSON.stringify(p.growthAssumptions || {}, null, 2);

document.getElementById("ratioData").innerText =
  JSON.stringify(p.financialRatios || {}, null, 2);

document.getElementById("allocationData").innerText =
  JSON.stringify(p.incomeAllocation || {}, null, 2);
</script>

</body>
</html>
