<!DOCTYPE html>
<html lang="ne">
<head>
<meta charset="UTF-8">
<title>Business Detail | BPMS</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
  font-family:"Noto Sans Devanagari","Kalimati","Mangal","Nirmala UI",system-ui,Arial;
  background:#f4f7f6;
  margin:0;
}
.container{
  max-width:900px;
  margin:25px auto;
  background:#fff;
  padding:25px;
  border-radius:10px;
}
h2{margin-top:0;color:#2e7d32}
h3{margin-top:25px}

/* ===== PROGRESS ===== */
.progress-wrap{
  background:#e8f5e9;
  border:1px solid #c8e6c9;
  padding:12px;
  border-radius:8px;
  margin-bottom:15px;
}
.progress-title{font-weight:700;margin-bottom:6px}
.steps{font-size:13px}
.steps span{
  padding:3px 6px;
  border-radius:10px;
  background:#eee;
}
.steps .active{
  background:#2e7d32;
  color:#fff;
}
.bar-wrap{
  height:8px;
  background:#ddd;
  border-radius:6px;
  overflow:hidden;
  margin-top:8px;
}
.bar{
  height:100%;
  background:#2e7d32;
  width:28%;
}

/* ===== FORM ===== */
label{
  display:block;
  font-weight:600;
  margin-top:15px;
}
input,textarea{
  width:100%;
  padding:8px;
  margin-top:6px;
  font-family:inherit;
}
textarea{min-height:80px}

#autosaveStatus{
  font-size:13px;
  color:#2e7d32;
  margin-bottom:10px;
}

.topic-box{
  border:1px solid #ddd;
  padding:15px;
  border-radius:8px;
  margin-top:15px;
}

button{
  padding:8px 16px;
  border:none;
  border-radius:6px;
  cursor:pointer;
  background:#2e7d32;
  color:#fff;
  margin-top:15px;
}

.nav{
  display:flex;
  justify-content:space-between;
  margin-top:30px;
}
</style>
</head>

<body>

<div class="container">

<!-- PROGRESS -->
<div class="progress-wrap">
  <div class="progress-title">‡§ö‡§∞‡§£ ‡•® / ‡•≠ (‡•®‡•Æ%)</div>
  <div class="steps">
    <span>Short Info</span> ‚Üí
    <span class="active">Detail</span> ‚Üí
    <span>Expense</span> ‚Üí
    <span>Income</span> ‚Üí
    <span>Profit</span> ‚Üí
    <span>ROI</span> ‚Üí
    <span>Proposal</span>
  </div>
  <div class="bar-wrap"><div class="bar"></div></div>
</div>

<div id="autosaveStatus">üíæ Saved</div>

<h2>üìã ‡§µ‡•ç‡§Ø‡§µ‡§∏‡§æ‡§Ø / ‡§™‡§∞‡§ø‡§Ø‡•ã‡§ú‡§®‡§æ‡§ï‡•ã ‡§µ‡§ø‡§∏‡•ç‡§§‡•É‡§§ ‡§µ‡§ø‡§µ‡§∞‡§£</h2>

<!-- ADD TOPIC -->
<div class="topic-box">
  <label>‡§µ‡§ø‡§∑‡§Ø (Topic)</label>
  <input id="topicInput" placeholder="‡§ú‡§∏‡•ç‡§§‡•à: ‡§µ‡•ç‡§Ø‡§µ‡§∏‡§æ‡§Ø‡§ï‡•ã ‡§™‡•É‡§∑‡•ç‡§†‡§≠‡•Ç‡§Æ‡§ø">

  <label>‡§µ‡§ø‡§µ‡§∞‡§£ (Content)</label>
  <textarea id="contentInput" placeholder="‡§Ø‡§∏ ‡§µ‡§ø‡§∑‡§Ø‡§ï‡•ã ‡§µ‡§ø‡§∏‡•ç‡§§‡•É‡§§ ‡§µ‡§ø‡§µ‡§∞‡§£ ‡§≤‡•á‡§ñ‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç"></textarea>

  <button onclick="addTopic()">Ôºã Add Topic</button>
</div>

<!-- DISPLAY -->
<div id="topicList"></div>

<!-- NAV -->
<div class="nav">
  <button onclick="goPrev()">‚¨Ö Short Info</button>
  <button onclick="goNext()">Next ‚û°</button>
</div>

</div>

<script>
/* ===== SAFETY ===== */
let activeKey = localStorage.getItem("activeProject");
if(!activeKey){
  alert("‡§™‡§π‡§ø‡§≤‡•á Home ‡§¨‡§æ‡§ü Project ‡§ñ‡•ã‡§≤‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç");
  location.href="index.html";
}
let project = JSON.parse(localStorage.getItem(activeKey));

if(!project.businessDetail){
  project.businessDetail = [];
}

/* ===== RENDER ===== */
function renderTopics(){
  let list = document.getElementById("topicList");
  list.innerHTML = "";

  if(project.businessDetail.length === 0){
    list.innerHTML = `
      <div style="color:#777;font-style:italic;margin-top:15px">
        üìå ‡§ï‡•Å‡§®‡•à ‡§µ‡§ø‡§µ‡§∞‡§£ ‡§•‡§™‡§ø‡§è‡§ï‡•ã ‡§õ‡•à‡§®
      </div>
    `;
    return;
  }

  project.businessDetail.forEach((t,i)=>{
    let div = document.createElement("div");
    div.className = "topic-box";
    div.innerHTML = `
      <h3>${i+1}. ${t.topic}</h3>
      <p>${t.content.replace(/\\n/g,"<br>")}</p>
    `;
    list.appendChild(div);
  });
}
renderTopics();

/* ===== ADD ===== */
function addTopic(){
  let topic = topicInput.value.trim();
  let content = contentInput.value.trim();
  if(!topic || !content){
    alert("‡§µ‡§ø‡§∑‡§Ø ‡§∞ ‡§µ‡§ø‡§µ‡§∞‡§£ ‡§¶‡•Å‡§µ‡•à ‡§≤‡•á‡§ñ‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç");
    return;
  }

  project.businessDetail.push({topic,content});
  saveDetail();

  topicInput.value="";
  contentInput.value="";
  renderTopics();
}

/* ===== SAVE ===== */
function saveDetail(){
  project.lastEdited = new Date().toLocaleString("ne-NP");
  localStorage.setItem(activeKey,JSON.stringify(project));
  autosaveStatus.innerText="‚úî Saved";
}

/* ===== NAV ===== */
function goPrev(){ location.href="short-info.html"; }
function goNext(){ saveDetail(); location.href="expense-demo.html"; }
</script>

</body>
</html>
