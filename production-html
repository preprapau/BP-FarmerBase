<!DOCTYPE html>
<html lang="ne">
<head>
<meta charset="UTF-8">
<title>Production | FarmerBase BP Engine</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
  font-family:"Noto Sans Devanagari","Kalimati",system-ui;
  background:#f4f7f6;
  margin:0;
}
header,footer{
  background:#e8f5e9;
  padding:10px 16px;
  display:flex;
  justify-content:space-between;
  align-items:center;
}
header a,footer a{
  text-decoration:none;
  font-weight:700;
  color:#2e7d32;
}
.container{
  max-width:1200px;
  margin:0 auto;
  padding:20px;
}
h2{color:#2e7d32;margin-bottom:6px}
.small{font-size:13px;color:#555;margin-bottom:12px}

table{
  width:100%;
  border-collapse:collapse;
  background:#fff;
}
th,td{
  border:1px solid #ccc;
  padding:6px;
  font-size:14px;
}
th{background:#eef5ee}
input,select,textarea{
  width:100%;
  padding:6px;
  box-sizing:border-box;
}
textarea{resize:vertical}

.addBtn{
  margin:10px 0;
  padding:8px 14px;
  background:#2e7d32;
  color:#fff;
  border:none;
  cursor:pointer;
}
.delBtn{
  color:#c62828;
  cursor:pointer;
  font-weight:700;
}

.reportBar{
  margin-top:16px;
  display:flex;
  gap:10px;
  flex-wrap:wrap;
}
.reportBar a{
  background:#fff;
  border:2px solid #2e7d32;
  padding:8px 12px;
  font-weight:700;
  color:#2e7d32;
  text-decoration:none;
}
</style>
</head>

<body>

<header>
  <!-- тЭМ download attribute рдЫреИрди -->
  <a href="index.html" target="_blank">ЁЯПа Home</a>
  <strong>рдЙрддреНрдкрд╛рджрди рд╡рд┐рд╡рд░рдг (Production)</strong>
  <a href="expense-demo.html">тЮбя╕П Expense</a>
</header>

<div class="container">

<h2>ЁЯМ▒ рдЙрддреНрдкрд╛рджрди рд╡рд┐рд╡рд░рдг (Production Master)</h2>
<p class="small">
рдпрд╣рд╛рдБ рдкреНрд░рд╡рд┐рд╖реНрдЯ рдЧрд░рд┐рдПрдХреЛ рдЙрддреНрдкрд╛рджрди рд╡рд┐рд╡рд░рдг Expense, Income, ROI рддрдерд╛ Proposal рдХреЛ
рдЖрдзрд╛рд░ рд╣реБрдиреЗрдЫред
</p>

<table>
<thead>
<tr>
  <th style="width:20%">рдЙрддреНрдкрд╛рджрди рдирд╛рдо</th>
  <th style="width:14%">рдкреНрд░рдХрд╛рд░</th>
  <th style="width:12%">рдкрд░рд┐рдорд╛рдг</th>
  <th style="width:12%">рдЗрдХрд╛рдЗ</th>
  <th>рдЯрд┐рдкреНрдкрдгреА</th>
  <th style="width:6%">тЭМ</th>
</tr>
</thead>
<tbody id="prodBody"></tbody>
</table>

<button class="addBtn" onclick="addProduct()">тЮХ рдирдпрд╛рдБ рдЙрддреНрдкрд╛рджрди</button>

<!-- REPORTS : NEW TAB ONLY -->
<div class="reportBar">
  <a href="production-report.html" target="_blank">ЁЯУК Production Summary</a>
  <a href="production-charts.html" target="_blank">ЁЯез Production Charts</a>
  <a href="production-income-link.html" target="_blank">ЁЯУИ Prod тЖТ Income</a>
  <a href="production-narrative.html" target="_blank">ЁЯУЭ Production Narrative</a>
</div>

</div>

<footer>
  <span class="small">
    FarmerBase BP Engine тАУ Production Source of Truth
  </span>
</footer>

<script>
/* ===============================
   PRODUCTION MASTER тАУ FINAL
   =============================== */

const key = localStorage.getItem("activeProject");
if(!key){
  alert("Active рдпреЛрдЬрдирд╛ рднреЗрдЯрд┐рдПрди ред index рдмрд╛рдЯ рдпреЛрдЬрдирд╛ рд╕реБрд░реБ рдЧрд░реНрдиреБрд╣реЛрд╕реНред");
}

let project = JSON.parse(localStorage.getItem(key)) || {};
project.productionProducts = project.productionProducts || [];

function save(){
  localStorage.setItem(key, JSON.stringify(project));
}

function render(){
  prodBody.innerHTML="";
  project.productionProducts.forEach((p,i)=>{
    const tr=document.createElement("tr");
    tr.innerHTML=`
<td>
  <input value="${p.name||""}"
    oninput="update(${i},'name',this.value)">
</td>

<td>
  <select onchange="update(${i},'type',this.value)">
    <option ${p.type==="рдкрд╢реБрдЬрдиреНрдп"?"selected":""}>рдкрд╢реБрдЬрдиреНрдп</option>
    <option ${p.type==="рддрд░рдХрд╛рд░реА"?"selected":""}>рддрд░рдХрд╛рд░реА</option>
    <option ${p.type==="рджреБрдЧреНрдз"?"selected":""}>рджреБрдЧреНрдз</option>
    <option ${p.type==="рдЕрдиреНрдп"?"selected":""}>рдЕрдиреНрдп</option>
  </select>
</td>

<td>
  <input type="number" min="0"
    value="${p.qty||0}"
    oninput="update(${i},'qty',this.value)">
</td>

<td>
  <input value="${p.unit||""}"
    oninput="update(${i},'unit',this.value)">
</td>

<td>
  <textarea rows="2"
    oninput="update(${i},'note',this.value)">${p.note||""}</textarea>
</td>

<td class="delBtn" onclick="remove(${i})">тЬЦ</td>
    `;
    prodBody.appendChild(tr);
  });
}

function addProduct(){
  project.productionProducts.push({
    id:"prod_"+Date.now(),
    name:"",
    type:"рддрд░рдХрд╛рд░реА",
    qty:0,
    unit:"",
    note:""
  });
  save(); render();
}

function update(i,field,value){
  project.productionProducts[i][field] =
    field==="qty" ? Number(value)||0 : value;
  save();
}

function remove(i){
  if(!confirm("рдпреЛ рдЙрддреНрдкрд╛рджрди рд╣рдЯрд╛рдЙрдиреЗ ?")) return;
  project.productionProducts.splice(i,1);
  save(); render();
}

render();
</script>

</body>
</html>
