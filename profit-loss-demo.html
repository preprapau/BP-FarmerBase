<!DOCTYPE html>
<html lang="ne">
<head>
<meta charset="UTF-8">
<title>Profit / Loss | BPMS</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{font-family:"Noto Sans Devanagari","Kalimati";background:#f4f7f6;margin:0}
.wrap{max-width:950px;margin:25px auto;background:#fff;padding:25px;border-radius:10px}
h2{color:#2e7d32}
table{width:100%;border-collapse:collapse}
th,td{border:1px solid #ccc;padding:8px}
th{background:#f0f0f0}
.big{font-size:22px;font-weight:700}
.green{background:#e8f5e9}
.nav{display:flex;justify-content:space-between;margin-top:25px}
button{padding:8px 16px;border:none;border-radius:6px;background:#2e7d32;color:#fff;cursor:pointer}
</style>
</head>

<body>
<div class="wrap">

<h2>üìä ‡§®‡§æ‡§´‡§æ / ‡§®‡•ã‡§ï‡•ç‡§∏‡§æ‡§® (‡§µ‡§æ‡§∞‡•ç‡§∑‡§ø‡§ï)</h2>

<table>
<tr><th>‡§ï‡•Å‡§≤ ‡§Ü‡§Æ‡•ç‡§¶‡§æ‡§®‡•Ä</th><td id="income">0</td></tr>
<tr><th>‡§ö‡§æ‡§≤‡•Å ‡§ñ‡§∞‡•ç‡§ö</th><td id="cash">0</td></tr>
<tr><th>‡§π‡•ç‡§∞‡§æ‡§∏‡§ï‡§ü‡•ç‡§ü‡•Ä</th><td id="depr">0</td></tr>
<tr><th>‡§ï‡•Å‡§≤ ‡§ñ‡§∞‡•ç‡§ö</th><td id="total">0</td></tr>
<tr class="green big"><th>‡§®‡§æ‡§´‡§æ / ‡§®‡•ã‡§ï‡•ç‡§∏‡§æ‡§®</th><td id="profit">0</td></tr>
</table>

<div class="nav">
  <button onclick="location.href='income-demo.html'">‚¨Ö Previous</button>
  <button onclick="location.href='five-year-roi.html'">Next ‚û°</button>
</div>

</div>

<script>
let key=localStorage.getItem("activeProject");
if(!key){alert("‡§™‡§π‡§ø‡§≤‡•á Project ‡§ñ‡•ã‡§≤‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç");location.href="index.html";}
let p=JSON.parse(localStorage.getItem(key));

let income=0;
(p.incomeData||[]).forEach(i=>income+=Number(i.amount||0));

let cash=0,depr=0;
(p.expenseData||[]).forEach(e=>{
  if(e.category==="‡§Æ‡•á‡§∂‡•Ä‡§® ‡§î‡§ú‡§æ‡§∞ / ‡§™‡•ç‡§∞‡§µ‡§ø‡§ß‡§ø"||e.category==="‡§™‡•Ç‡§∞‡•ç‡§µ‡§æ‡§ß‡§æ‡§∞ ‡§®‡§ø‡§∞‡•ç‡§Æ‡§æ‡§£")
    depr+=e.amount*0.15;
  else cash+=e.amount;
});

incomeEl=income;
cashEl=cash;
deprEl=Math.round(depr);
totalEl=Math.round(cash+depr);
profitEl=Math.round(income-totalEl);

income.textContent=incomeEl;
cash.textContent=cashEl;
depr.textContent=deprEl;
total.textContent=totalEl;
profit.textContent=profitEl;
</script>
</body>
</html>
